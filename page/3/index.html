<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/img/lufei.ico?v=5.1.2" />






<meta name="description" content="世之奇伟、瑰怪，非常之观，常在于险远，而人之所罕至焉，故非有志者不能至也">
<meta property="og:type" content="website">
<meta property="og:title" content="Youmai の Blog">
<meta property="og:url" content="http://yoursite.com/page/3/index.html">
<meta property="og:site_name" content="Youmai の Blog">
<meta property="og:description" content="世之奇伟、瑰怪，非常之观，常在于险远，而人之所罕至焉，故非有志者不能至也">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Youmai の Blog">
<meta name="twitter:description" content="世之奇伟、瑰怪，非常之观，常在于险远，而人之所罕至焉，故非有志者不能至也">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"right","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/3/"/>





  <title>Youmai の Blog</title>
  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-63551049-1', 'auto');
  ga('send', 'pageview');
</script>





</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-right 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Youmai の Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/11/08/Django-优化数据库查询/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="You Wangqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/lufei.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Youmai の Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/11/08/Django-优化数据库查询/" itemprop="url">Django-优化数据库查询</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-11-08T21:09:31+08:00">
                2015-11-08
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Django/" itemprop="url" rel="index">
                    <span itemprop="name">Django</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>##一次检索你需要的所有东西</p>
<p>在不同的位置多次访问数据库，一次获取一个数据集，通常来说不如在一次查询中获取它们更高效。如果你在一个循环中执行查询，这尤其重要。有可能你会做很多次数据库查询，但只需要一次就够了。</p>
<p>我们需要充分了解并使用<code>select_related()</code>和<code>prefetch_related()</code></p>
<p>###select_related()<br>Returns a QuerySet that will <code>“follow”</code> foreign-key relationships, selecting additional related-object data when it executes its query. This is a performance booster which results in a single more complex query but means later use of foreign-key relationships won’t require database queries.</p>
<p>The following examples illustrate the difference between plain lookups and select_related() lookups. Here’s standard lookup:</p>
<pre><code># Hits the database.
e = Entry.objects.get(id=5)

# Hits the database again to get the related Blog object.
b = e.blog
</code></pre><p>And here’s select_related lookup:</p>
<pre><code># Hits the database.
e = Entry.objects.select_related(&apos;blog&apos;).get(id=5)

# Doesn&apos;t hit the database, because e.blog has been prepopulated
# in the previous query.
b = e.blog
</code></pre><p>You can use <code>select_related()</code> with any queryset of objects:</p>
<pre><code>from django.utils import timezone

# Find all the blogs with entries scheduled to be published in the future.
blogs = set()

for e in Entry.objects.filter(pub_date__gt=timezone.now()).select_related(&apos;blog&apos;):
    # Without select_related(), this would make a database query for each
    # loop iteration in order to fetch the related blog for each entry.
    blogs.add(e.blog)
</code></pre><p>The order of <code>filter()</code> and <code>select_related()</code> chaining isn’t important. These querysets are equivalent:</p>
<pre><code>Entry.objects.filter(pub_date__gt=timezone.now()).select_related(&apos;blog&apos;)
Entry.objects.select_related(&apos;blog&apos;).filter(pub_date__gt=timezone.now())
</code></pre><p>You can follow foreign keys in a similar way to querying them. If you have the following models:</p>
<pre><code>from django.db import models

class City(models.Model):
    # ...
    pass

class Person(models.Model):
    # ...
    hometown = models.ForeignKey(City)

class Book(models.Model):
    # ...
    author = models.ForeignKey(Person)
</code></pre><p>… then a call to <code>Book.objects.select_related(&#39;author__hometown&#39;).get(id=4)</code> will cache the related Person and the related City:</p>
<pre><code>b = Book.objects.select_related(&apos;author__hometown&apos;).get(id=4)
p = b.author         # Doesn&apos;t hit the database.
c = p.hometown       # Doesn&apos;t hit the database.

b = Book.objects.get(id=4) # No select_related() in this example.
p = b.author         # Hits the database.
c = p.hometown       # Hits the database.
</code></pre><p>###prefetch_related()<br>待补充</p>
<p>##不要查询你不需要的东西</p>
<p>###使用<code>QuerySet.values()</code>和<code>values_list()</code><br>当你仅仅想要一个带有值的字典或者列表，并不需要使用ORM模型对象时，可以适当使用<code>values()</code>。</p>
<p>###使用<code>QuerySet.count()</code><br>如果你想要获取大小，不要使用 <code>len(queryset)</code></p>
<p>###使用<code>QuerySet.exists()</code><br>如果你想要知道是否存在至少一个结果，不要使用<code>if queryset</code></p>
<p>###使用<code>QuerySet.update()</code>和<code>delete()</code><br>通过<code>QuerySet.update()</code>使用批量的SQL UPDATE语句，而不是获取大量对象，设置一些值再单独保存。与此相似，在可能的地方使用批量<code>deletes</code>。</p>
<p>但是要注意，这些批量的更新方法不会在单独的实例上面调用<code>save()</code>或者<code>delete()</code>方法，意思是任何你向这些方法添加的自定义行为都不会被执行，包括由普通数据库对象的信号驱动的任何方法。</p>
<p>###直接使用外键的值<br>如果你仅仅需要外键当中的一个值，要使用对象上你已经取得的外键的值，而不是获取整个关联对象再得到它的主键。例如，执行：</p>
<pre><code>entry.blog_id
</code></pre><p>而不是：</p>
<pre><code>entry.blog.id
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/08/23/Django-Interview/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="You Wangqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/lufei.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Youmai の Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/08/23/Django-Interview/" itemprop="url">Django Interview</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-08-23T10:46:48+08:00">
                2015-08-23
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Django/" itemprop="url" rel="index">
                    <span itemprop="name">Django</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>##Django的Model的继承有几种形式，分别是什么？</p>
<p>###抽象继承：</p>
<p>顺便复习OOP思想，继承是面向对象的大前提。抽象类之所以被创建是用来被继承的；一个类如果包含任何一种抽象方法，那么它就是抽象类；抽象方法一定要在子类中被复写；在继承关系中，抽象类永远在树枝节点上，而且对于Python来说，已经没有这么多约束了。</p>
<p>回到Django的<code>Model</code>也一样，当我们需要某些公共方法字段时，就需要一个父类为其他子类服务，这个父类没有<code>manager</code>，Django也不为这个类创建表，这种继承的定义方法如下：</p>
<pre><code>class Animal(models.Model):
    name = models.CharField(max_length=50)
    age = models.PositiveIntegerField()

    # 下面这句决定了Animal是一个抽象类/Model
    class Meta:
        abstract = True


class Human(Animal):
    kind_hearted = models.BooleanField()
    sex = models.CharField(&apos;sex&apos;, choices=((&apos;m&apos;,&apos;male&apos;), (&apos;f&apos;, &apos;female&apos;)), max_length=1)
    #...
</code></pre><p>上例中，<code>Human</code>的子<code>model</code>中，自然包含了<code>name</code>和<code>age</code>的字段，但是Animal不能作为正常model使用，由于没有manager，所以也不能实例化、保存。在子类中，不可以建立与这个抽象父类中的相同的字段，Django表示对报错负责。</p>
<p>###正常的继承，多重继承，Joined映射<br>和抽象继承的主要区别是父类这时也可以拥有数据库表了，并且不在身为存储公共信息的抽象类了，父类也可以进行实例化，查询等操作了。</p>
<pre><code>class Country(models.Model):
    name = models.CharField(max_length=10)
    #...


class Province(Country):
    return = models.BooleanField()
    #...
</code></pre><p>###代理<br>即在子类中只能增加方法，而不能增加属性，在不影响父类数据存储的前提下，使子类继承父类，此时子类称为父类的<code>“代理”</code>。例如：</p>
<pre><code>from django.contrib.auth.models import User

class Person(User):
    # this makes a class proxy
    proxy = True

    def can_dance(self):
        return True


# both Yellow and Black can_dance :)
class Yellow(Person):
    hometown = models.CharField(max_length=30)


class Black(Person)
    tribe_name = models.CharField(max_length=100)
</code></pre><p>我们为<code>Person</code>类增加了一个方法，可以跳舞，并且保持了<code>User</code>的数据字段的不变。</p>
<p>##Django的Queryset是什么，objects是什么，objects在哪里可以定义</p>
<p><code>query + set</code>，已经能猜出大概，它对应着数据库中的若干条记录。</p>
<p>例如有一个叫做<code>Order</code>的模型，在project的根目录下进入shell进行操作：</p>
<pre><code>$python manage.py shell
&gt;&gt;&gt;from app.order.models import Order
&gt;&gt;&gt;type(Order.objects)
&lt;class &apos;django.db.models.models.manager.Manager&apos;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt;order = Order.objects.all()
&gt;&gt;&gt;type(order)
&lt;class &apos;django.db.models.query.QuerySet&apos;&gt;
</code></pre><p>上述方法很常用，看继承关系去理解<code>Queryset</code>和<code>objets</code>。<code>objects</code>是每个<code>Model</code>默认的<code>manager</code>类，通过manager的方法(也可通过<code>QuerySet</code>的方法得到，当然<code>QuerySet</code>也来自于<code>manager</code>)，得到相应的<code>Queryset</code>，用以对数据库模型字段进行更多的操作。</p>
<p><code>objects(manager)</code>方法可以自定义添加，也可以直接赋值覆盖掉默认的管理方法。</p>
<p>试着添加一个新的管理器的步骤是这样，首先定义一个<code>manager</code>类继承自<code>models.Manager</code>，并在其中对self进行操作，如下：</p>
<pre><code># new manager
class OrderManager(models.Manager):
    def title_count(self, keyword):
        return self.filter(title__icontains=keyword).count()


class Order(models.Models):
    title = models.CharField(max_length=100)
    # ...
    #objects = models.Manager()
    objects = OrderManager()

    def __unicode__(self):
        return self.title
</code></pre><p>上述例子中我们把<code>OrderManager</code>赋值给了<code>objects</code>，替换了默认的管理器。</p>
<p><strong>tips</strong>:如果增加了新的管理器，且没有替换掉默认管理器，那么默认管理器需要显式的声明出来才可以使用。</p>
<p>##Django中查询queryset时什么情况下用Q?</p>
<p>在进行相对复杂的查询时，使用<code>django.db.models.Q</code>对象。</p>
<p>例如需要进行复合条件的查询的SQL语句如下：</p>
<pre><code>SELECT * FROM order WHERE id BETWEEN 20 ADN 100 AND(num &lt;= &apos;20&apos; or num &gt;= &apos;30&apos;);
</code></pre><p>使用Q就可以写成：</p>
<pre><code>from django.db.models import Q
from login.models import Order
#...
Order.objects.get(
Q(id &gt;= 20) &amp; (id &lt;= 100),
Q(num &lt;= 20) | (num &gt;= 30)
)
</code></pre><p>##Django中想验证表单提交是否格式正确需要用到Form中的哪个函数？</p>
<p><code>is_valid()</code>函数方法，用于检查表单提交是否正确。</p>
<p>##Django取消级联删除</p>
<p>这个文档写的比较清楚：</p>
<pre><code>user = models.ForeignKey(User, blank=True, null=True, on_delete=models.SET_NULL)
</code></pre><p>并且<code>SET_NULL</code>只有在<code>null</code>为<code>True</code>的时候，才可以使用。</p>
<p>##Django中如何在Model保存前做一定的固定操作，比如写一句日志？</p>
<p>关键词: <strong>信号</strong></p>
<p>利用<code>Django</code>的<code>Model</code>的<code>Signal Dispatcher</code>, 通过<code>django.db.models.signals.pre_save()</code>方法，在事件发生前，发射触发信号，这一切都被调度中的<code>receiver</code>方法深藏功与名的保存了。<br>信号的处理一般都写在<code>Model</code>中，举个例子：</p>
<pre><code>import logging
from django.db import models
from django.db.models.signals import pre_save
from django.dispatch import receiver

class Order(models.Model):
    # ...


logger = logging.getLogger(__name__)

@receiver(pre_save, sender=Order)
def pre_save_handler(sender, **kwargs):

    # 我们可以在Order这个Model保存之前尽情玩耍
    logger.debug(&quot;{},{}&quot;.format(sender, **kwargs))
    print &apos;fuck universe&apos;
</code></pre><p>这样应该就实现了题中的要求，类似的方法还有比如<code>pre_init</code>是在<code>Model</code>实例之前会触发，<code>post_init</code>在实例之后触发，同理就是<code>pre_save</code>和<code>post_save</code>了。</p>
<p>##Django中如何读取和保存session，整个session的运行机制是什么。</p>
<p>说到<code>session</code>的运行机制，就一定要先说一下<code>cookie</code>这一段信息。一般情况下<code>cookies</code>都是我们的浏览器生成的（显然可以人为修改），用于服务器对户进行筛选和维护，但是这个听上去很好吃的东西，能存的东西有点少而且容易被别人利用。这时候基于<code>cookies</code>的<code>session</code>的意义就比较明显了，在客户端的<code>cookies</code>中我们只保存<code>session id</code>，而将完整信息以加密信息的形式保存到服务器端，这样服务器可以根据<code>session id</code>相对安全的在数据库中查询用户的更细致的信息和状态。</p>
<p>在Django中<code>session</code>和<code>cookies</code>的操作方法一样，如下：</p>
<pre><code># 保存session
request.session[&apos;order_id&apos;] = order_id
# 删除session
del request.session[&apos;order_id&apos;]
# 读取session
session.get(&apos;order_id&apos;, False)
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/08/10/Django的F-表达式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="You Wangqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/lufei.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Youmai の Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/08/10/Django的F-表达式/" itemprop="url">Django的F()表达式</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-08-10T23:00:20+08:00">
                2015-08-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Django/" itemprop="url" rel="index">
                    <span itemprop="name">Django</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>算是一些基本的高级用法吧，在Django文档的<a href="https://docs.djangoproject.com/en/1.7/ref/models/queries/" target="_blank" rel="external">Query-related classes</a>这一章中。主要讲了三个类，<code>F()</code>,<code>Q()</code>和<code>prefetch()</code>。我们下面讲一讲<code>F()</code>。</p>
<blockquote>
<p>class F()<br>F()是代表模型字段的值，也就是说对于一些特殊的字段的操作，我们不需要用python把数据先取到内存中，然后操作，在存储到db中了。</p>
</blockquote>
<p>##常见的使用场景</p>
<p>###字段加1(加减乘除运算)</p>
<p>例如我们有个统计点击量的字段，每次更新的操作其实就是把字段的值加1.</p>
<p>一般我们的做法是把这条记录取出来，把相应字段加+1，然后在save，类似下面的代码</p>
<pre><code># Tintin filed a news story!
reporter = Reporters.objects.get(name=&apos;Tintin&apos;)
reporter.stories_filed += 1
reporter.save()
</code></pre><p>当我们使用了<code>F()</code>之后呢？ 只需要一行代码</p>
<pre><code>Reporters.objects.filter(name=&apos;Tintin&apos;).update(stories_filed=F(&apos;stories_filed&apos;) + 1)
</code></pre><p>不仅代码量少了，而且这是直接在数据中操作，效率也变高了，特别是并发的情况，减少了多线程同时操作带来的隐患。 但是<strong>不支持字符串相加的操作</strong></p>
<p>###字段比较<br>例如一个合同有两个日期，一个叫做终止日期，一个叫做结束日期，现在要筛选出终止日期小于结束日期的合同。</p>
<pre><code>from django.db.models import F
from contracts.models import Contracts
contracts = Contracts.objects.filter(contract_stop_time__lt=F(&apos;end_time&apos;))
</code></pre><p>如果没有F对象，就没法直接使用rom来查询。</p>
<p>###补充–通过F()避免竞态条件</p>
<blockquote>
<p>Another useful benefit of <code>F()</code> is that having the database - rather than Python - update a field’s value avoids a race condition.</p>
<p>If two Python threads execute the code in the first example above, one thread could retrieve, increment, and save a field’s value after the other has retrieved it from the database. The value that the second thread saves will be based on the original value; the work of the first thread will simply be lost.</p>
<p>If the database is responsible for updating the field, the process is more robust: it will only ever update the field based on the value of the field in the database when the <code>save()</code> or <code>update()</code> is executed, rather than based on its value when the instance was retrieved.</p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/08/03/python-double-star-and-star/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="You Wangqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/lufei.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Youmai の Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/08/03/python-double-star-and-star/" itemprop="url">python (double star) and (star)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-08-03T19:43:55+08:00">
                2015-08-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index">
                    <span itemprop="name">python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>这个东西我开始根本不知道该怎么搜，找了很久才在stackoverflow上得到了指点，如果你需要搜一些别的答案，可以尝试搜索(double star in python)， 下面是一个非常棒的回答。</p>
<p>原文<a href="http://stackoverflow.com/questions/2921847/what-does-the-star-operator-mean-in-python" target="_blank" rel="external">在此</a></p>
<p>The single star <code>*</code> unpacks the sequence/collection into positional arguments, so you can do this:</p>
<pre><code>def sum(a, b):
    return a + b

values = (1, 2)

s = sum(*values)
</code></pre><p>This will unpack the tuple so that it actually executes as:</p>
<pre><code>s = sum(1, 2)
</code></pre><p>The double star <code>**</code> does the same, only using a dictionary and thus named arguments:</p>
<pre><code>values = { &apos;a&apos;: 1, &apos;b&apos;: 2 }
s = sum(**values)
</code></pre><p>You can also combine:</p>
<pre><code>def sum(a, b, c, d):
    return a + b + c + d

values1 = (1, 2)
values2 = { &apos;c&apos;: 10, &apos;d&apos;: 15 }
s = sum(*values1, **values2)
</code></pre><p>will execute as:</p>
<pre><code>s = sum(1, 2, c=10, d=15)
</code></pre><p>Also see section <a href="http://docs.python.org/tutorial/controlflow.html#unpacking-argument-lists" target="_blank" rel="external">4.7.4 - Unpacking Argument Lists</a> of the Python documentation.</p>
<hr>
<p>Additionally you can define functions to take <code>*x</code> and <code>**y</code> arguments, this allows a function to accept any number of positional and/or named arguments that aren’t specifically named in the declaration.</p>
<p>Example:</p>
<pre><code>def sum(*values):
    s = 0
    for v in values:
        s = s + v
    return s

s = sum(1, 2, 3, 4, 5)
</code></pre><p>or with <code>**</code>:</p>
<pre><code>def get_a(**values):
    return values[&apos;a&apos;]

s = get_a(a=1, b=2)      # returns 1
</code></pre><p>this can allow you to specify a large number of optional parameters without having to declare them.</p>
<p>And again, you can combine:</p>
<pre><code>def sum(*values, **options):
    s = 0
    for i in values:
        s = s + i
    if &quot;neg&quot; in options:
        if options[&quot;neg&quot;]:
            s = -s
    return s

s = sum(1, 2, 3, 4, 5)            # returns 15
s = sum(1, 2, 3, 4, 5, neg=True)  # returns -15
s = sum(1, 2, 3, 4, 5, neg=False) # returns 15
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/07/22/Django-统计查询/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="You Wangqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/lufei.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Youmai の Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/07/22/Django-统计查询/" itemprop="url">Django-统计查询</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-07-22T19:24:08+08:00">
                2015-07-22
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Django/" itemprop="url" rel="index">
                    <span itemprop="name">Django</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>##统计<br><a href="http://docs.oneele.com/django/topics/db/queries.html" target="_blank" rel="external">Django 数据库抽象 API</a> 描述了如何创建、检索、更新和删除独立的对象。但是，有时你会需要处理一些有关对象的集合的统计。本文描述如何使用 Django 查询来处理统计。<br>本文我们将使用以下模型。这些模型用于在线书店图书清单：</p>
<pre><code>class Author(models.Model):
   name = models.CharField(max_length=100)
   age = models.IntegerField()
   friends = models.ManyToManyField(&apos;self&apos;, blank=True)

class Publisher(models.Model):
   name = models.CharField(max_length=300)
   num_awards = models.IntegerField()

class Book(models.Model):
   isbn = models.CharField(max_length=9)
   name = models.CharField(max_length=300)
   pages = models.IntegerField()
   price = models.DecimalField(max_digits=10, decimal_places=2)
   rating = models.FloatField()
   authors = models.ManyToManyField(Author)
   publisher = models.ForeignKey(Publisher)
   pubdate = models.DateField()

class Store(models.Model):
   name = models.CharField(max_length=300)
   books = models.ManyToManyField(Book)
</code></pre><p>##生成整个查询集的统计<br>Django 提供两种方法来产生统计。第一种方法是产生整个 查询集 的统计。假设我们要统计所有书的平均价格。 Djnago 中查询所有书的语句为:</p>
<pre><code>&gt;&gt;&gt; Book.objects.all()
</code></pre><p>在这个语句后加上一个 <code>aggregate()</code> 子句就行了:</p>
<pre><code>&gt;&gt;&gt; from django.db.models import Avg
&gt;&gt;&gt; Book.objects.all().aggregate(Avg(&apos;price&apos;))
{&apos;price__avg&apos;: 34.35}
</code></pre><p>上例中的 <code>all()</code> 是多余的。所以可以简写为:</p>
<pre><code>&gt;&gt;&gt; Book.objects.aggregate(Avg(&apos;price&apos;))
{&apos;price__avg&apos;: 34.35}
</code></pre><p><code>aggregate()</code>子句的参数代表我们要统计的内容，本例中我们要统计 Book 模型中 <code>price</code> 字段的平均值。 查询集参考 中可以找到完整的统计函数列表。<br><code>aggregate()</code>是一个 查询集 的未端子句，调用后会返回一个由名称－值配对组成的字典。名称是指统计的名称，值就是统计的值。名称由字段名称加上函数名自动组成。如果你想手动指定统计名称，可以象下例在统计子句中定义:</p>
<pre><code>&gt;&gt;&gt; Book.objects.aggregate(average_price=Avg(&apos;price&apos;))
{&apos;average_price&apos;: 34.35}
</code></pre><p>如果你想要生成多个统计，那么只要在统计子句后加上另外的统计子句就可以了。例如，如果要计算所有书价中最高价和最低价，可以这样写:</p>
<pre><code>&gt;&gt;&gt; from django.db.models import Avg, Max, Min, Count
&gt;&gt;&gt; Book.objects.aggregate(Avg(&apos;price&apos;), Max(&apos;price&apos;), Min(&apos;price&apos;))
{&apos;price__avg&apos;: 34.35, &apos;price__max&apos;: Decimal(&apos;81.20&apos;), &apos;price__min&apos;: Decimal(&apos;12.99&apos;)}
</code></pre><p>##生成查询集中每一个项目的统计<br>第二种方法是为 查询集 中每个独立的对象生成统计。例如，当你检索一个书单时，可能想知道每本书有几个作者。每本书与每个作者之间是一个多对多的关系，我们要为每本书总结这个关系。</p>
<p>要产生每个对象的统计可以使用 <code>annotate()</code> 子句。当定义一个 <code>annotate()</code> 子句后， 查询集 中的每个对象就可以与特定值关联，相当于每个对象有一个 “注释”。<br>这种注释的语法与 <code>aggregate()</code> 相同。 <code>annotate()</code> 的每个参数代表一个统计。例如，要计算每本书的作者人数:</p>
<pre><code># Build an annotated queryset
&gt;&gt;&gt; q = Book.objects.annotate(Count(&apos;authors&apos;))
# Interrogate the first object in the queryset
&gt;&gt;&gt; q[0]
&lt;Book: The Definitive Guide to Django&gt;
&gt;&gt;&gt; q[0].authors__count
2
# Interrogate the second object in the queryset
&gt;&gt;&gt; q[1]
&lt;Book: Practical Django Projects&gt;
&gt;&gt;&gt; q[1].authors__count
1
</code></pre><p>和 <code>aggregate()</code> 一样，统计的名称自动由字段名和函数名组成。你也可以在定义统计时指定名称:</p>
<pre><code>&gt;&gt;&gt; q = Book.objects.annotate(num_authors=Count(&apos;authors&apos;))
&gt;&gt;&gt; q[0].num_authors
2
&gt;&gt;&gt; q[1].num_authors
1
</code></pre><p>与 <code>aggregate()</code> 不同的是, <code>annotate()</code> 不是 一个未端子句。 <code>annotate()</code> 子句的输出是一个 查询集 。 这个 查询集 可以和其他查询集一样操作，包括 <code>filter()</code> 、 <code>order_by</code> 或者甚至再调用另一个 <code>annotate()</code> 。</p>
<p>##联合和统计<br>至此，我们统计的对象都是被查询的模块本身的字段。但是，有时我们要统计的是被查询模块的相关联的模块字段。<br>在统计函数中定义字段时，可以使用与过滤器中用于指定关联字段的 双下划线符号 。通过这种方法， Django 会自动使用联合来统计相关联的字段。</p>
<p>例如，要统计每个书店中书的价格范围:</p>
<pre><code>&gt;&gt;&gt; Store.objects.annotate(min_price=Min(&apos;books__price&apos;), max_price=Max(&apos;books__price&apos;))
</code></pre><p>上面的例子告诉 Django 检索 Store 模型，联合（通过多对多关系） Book 模型，并且统计 book 模型中的价格字段，计算最大值和最小值。<br><code>aggergate()</code> 子句适用同样规则。如果你想知道所有书店中书的最高价和最低价，可以这样:</p>
<pre><code>&gt;&gt;&gt; Store.objects.aggregate(min_price=Min(&apos;books__price&apos;), max_price=Max(&apos;books__price&apos;))
</code></pre><p>联合的深度是无限的。例如，要统计所有书的作者的最小年龄，你可以这样:</p>
<pre><code>&gt;&gt;&gt; Store.objects.aggregate(youngest_age=Min(&apos;books__authors__age&apos;))
</code></pre><p>##统计和其他查询子句</p>
<p>###<code>filter()</code> 和 <code>exclude()</code><br>在过滤器中也可以使用统计。任何用于一般模型的 <code>filter()</code> （或 <code>exclude()</code> ）也可与统计联用。</p>
<p>当与 <code>annotate()</code> 子句联用时，过滤器作用于被统计的对象上。例如要统计书名以 “Django” 开头的书:</p>
<pre><code>&gt;&gt;&gt; Book.objects.filter(name__startswith=&quot;Django&quot;).annotate(num_authors=Count(&apos;authors&apos;))
</code></pre><p>当与 <code>aggregate()</code> 子句联用时，过滤器作用于被统计的所有对象上。例如要统计书名以 “Django” 开头的书的平均价格:</p>
<pre><code>&gt;&gt;&gt; Book.objects.filter(name__startswith=&quot;Django&quot;).aggregate(Avg(&apos;price&apos;))
</code></pre><p>###过滤统计的值<br>统计出来的值也可以被过滤。和其他模型一样，统计的结果也可以使用 <code>filter()</code> 和 <code>exclude()</code> 子句来过滤。</p>
<p>例如，要产生一个由两个以上作者的书单可以这样:</p>
<pre><code>&gt;&gt;&gt; Book.objects.annotate(num_authors=Count(&apos;authors&apos;)).filter(num_authors__gt=1)
</code></pre><p>上例先进行统计，然后在统计的结果上使用了过滤器。</p>
<p>###<code>annotate()</code> 和 <code>filter()</code> 子句的顺序<br>当使用同时包含 <code>annotate()</code> 和 <code>filter()</code> 子句的复杂查询时，要特别小心两种子句的顺序。</p>
<p>当一个 <code>annotate()</code> 子句作用于查询时，该统计只对子句之前的查询起作用。也就是说 <code>filter()</code> 和 <code>annotate()</code> 顺序不同，查询就不同了。查询:</p>
<pre><code>&gt;&gt;&gt; Publisher.objects.annotate(num_books=Count(&apos;book&apos;)).filter(book__rating__gt=3.0)
</code></pre><p>和查询:</p>
<pre><code>&gt;&gt;&gt; Publisher.objects.filter(book__rating__gt=3.0).annotate(num_books=Count(&apos;book&apos;))
</code></pre><p>是不同的。两个查询都会返回至少有一本好书（评分大于 3.0 ）的出版商。但是，第一个查询中的统计会提供出版商的所有书的数量；第二个查询中的统计只返回好书的数量。第一个查询中统计先于过滤器，所以过滤器对统计没有作用。而第二个查询过滤器先于统计，所以统计的对象是已经过滤过的。</p>
<p>###order_by()<br>统计可以作为排序的基础。当你定义一个 <code>order_by</code> 子句时，可以引用 <code>annotate()</code> 子句中的统计。</p>
<p>例如，要依据书的作者人数进行排序，可以这样:</p>
<pre><code>&gt;&gt;&gt; Book.objects.annotate(num_authors=Count(&apos;authors&apos;)).order_by(&apos;num_authors&apos;)
</code></pre><p>###values()<br>通常,统计会针对 查询集 中每一个对象返回一个结果。但是，当使用 <code>values</code> 子句来约束要统计的列时，返回的结果会有所不同。原先统计结果中，统计字段的值相同的项会分组合并统计。<br>例如，要统计每个作者各自所写的书的平均评分:</p>
<pre><code>&gt;&gt;&gt; Author.objects.annotate(average_rating=Avg(&apos;book__rating&apos;))
</code></pre><p>返回的结果会包含每一个作者及其所写的书的平均计分。</p>
<p>但是，如果使用 <code>values()</code> 子句，返回的结果会有所不同:</p>
<pre><code>&gt;&gt;&gt; Author.objects.values(&apos;name&apos;).annotate(average_rating=Avg(&apos;book__rating&apos;))
</code></pre><p>这个例子中会把作者按名字分组统计，返回的结果中不会有重复的作者名字。名字相同的作者在统计中会作为同一个作者来统计，同名作者所写的书的评分会合并为一个作者的书来统计。</p>
<p>###<code>annotate()</code> 和 <code>values()</code> 子句的顺序<br>当使用 <code>filter()</code> 子句时， <code>annotate()</code> 和 <code>values()</code> 子句的顺序是非常重要的。如果 <code>values()</code> 子句先于 <code>annotate()</code> 子句，会按照前文所述的方式统计。</p>
<p>但是，如果 <code>annotate()</code> 子句先于 <code>values()</code> 子句，那么统计会作用于整个查询集，而 <code>values()</code> 子句只约束统计输出的字段。</p>
<p>例如，如果我们把前一个例子中的 <code>values()</code> 和 <code>annotate()</code> 子句调换顺序:</p>
<pre><code>&gt;&gt;&gt; Author.objects.annotate(average_rating=Avg(&apos;book__rating&apos;)).values(&apos;name&apos;, &apos;average_rating&apos;)
</code></pre><p>这个例子会为每一个作者生成唯一的结果。但是在输了的数据中只会包含作者名和 <code>average_rating</code> 的统计。</p>
<p>你可以注意到 <code>average_rating</code> 在例子中显示地定义了。在 <code>annotate()</code> 和 <code>values()</code> 子句的顺序处于这种情况是必须显式定义。</p>
<p>如果 <code>values()</code> 子句先于 <code>annotate()</code> 子句，那么任何统计会自动添加到输出结果中。但是 <code>values()</code> 子句在 <code>annotate()</code> 子句之后，那么必须显式定义统计列。</p>
<p>###缺省排序或 order_by() 子句的副作用<br>一个查询集中 <code>order_by()</code> 子句中的字段（或一个模型中缺省排序字段）会对输了数据产生影响，即使在 <code>values()</code> 中没有这些字段的定义时也同样会影响。这些特殊的字段会影响统计结果,这种情况在计数统计时尤为明显。</p>
<p>假设有一个这样的模型:</p>
<pre><code>class Item(models.Model):
    name = models.CharField(max_length=10)
    data = models.IntegerField()

    class Meta:
        ordering = [&quot;name&quot;]
</code></pre><p>这里的重点是作为缺省排序的 name 字段。如果你想要统计不重复的 data 值出现了多少次，你可能会使用如下语句:</p>
<pre><code># 警告：这个语句不完全正确！
Item.objects.values(&quot;data&quot;).annotate(Count(&quot;id&quot;))
</code></pre><p>…这个语句看似会根据 data 值分组统计 Item 对象的 id 。但统计结果中 name 字段也会参与其中，所以这个语句实际的是不重复的 <code>(data, name)</code> 配对，而这不是我们所要的结果，因此我们应当这样统计:</p>
<pre><code>Item.objects.values(&quot;data&quot;).annotate(Count(&quot;id&quot;)).order_by()
</code></pre><p>…这里我们通过一个空的<code>“ order_by() ”</code>来清除副作用。</p>
<p>这个行为与在查询集文档中 <code>distinct()</code> 提到的一样。通常的规则是：当你不想要额外的字段在统计结果中产生作用时，必须清空排序的内容或者至少确认 <code>values()</code> 子句中的字段已经限制了这些额外字段。</p>
<p>####Note<br>你可以会问为什么 Django 不去除这些字段的影响。主要的原因是为维护 <code>distinct()</code> 的一贯性和一个原则： Django 从不 删除你的排序定义（我们不会改变那么模型方法的行为，否则就会违背我们 <a href="http://docs.oneele.com/django/misc/api-stability.html" target="_blank" rel="external">API stability</a> 策略）。</p>
<p>###对小计进行统计<br>你可以对小计的结果进行统计。在查询中，你可以使用 <code>aggregate()</code> 子句来对 <code>annotate()</code>的结果进行统计。</p>
<p>例如，假设你要统计每本书的作者人数的平均值，那么首先要计算每本书的作者人数，然后根据这个结果来统计平均值:</p>
<pre><code>&gt;&gt;&gt; Book.objects.annotate(num_authors=Count(&apos;authors&apos;)).aggregate(Avg(&apos;num_authors&apos;))
{&apos;num_authors__avg&apos;: 1.66}
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/07/19/python排序函数/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="You Wangqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/lufei.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Youmai の Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/07/19/python排序函数/" itemprop="url">python排序函数</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-07-19T21:38:15+08:00">
                2015-07-19
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index">
                    <span itemprop="name">python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>##sort和sorted<br>相比于<code>sort</code>，<code>sorted()</code>的使用更为广泛</p>
<pre><code>sorted(iterable, cmp, key, reverse)
s.sort(cmp, key, reverse)
</code></pre><p><code>sorted</code>可以作用域任意迭代对象，而<code>sort()</code>一般作用于列表。</p>
<p><code>reverse = True</code>表示按照逆序排序</p>
<p>##sorted</p>
<p><code>sorted</code>排序的关键是传入<code>key</code>：</p>
<pre><code>In [35]: students = [(&apos;john&apos;, &apos;A&apos;, 15), (&apos;jane&apos;, &apos;B&apos;, 12), (&apos;dave&apos;, &apos;B&apos;, 10), (&apos;michael&apos;, &apos;A&apos;, 13), (&apos;mike&apos;, &apos;B&apos;, 12), (&apos;jessey&apos;, &apos;C&apos;, 15)]

In [36]: students = sorted(students, key=lambda result: result[2], reverse=True)
</code></pre><p>结果：</p>
<pre><code>In [37]: students
Out[37]:
[(&apos;john&apos;, &apos;A&apos;, 15),
 (&apos;jessey&apos;, &apos;C&apos;, 15),
 (&apos;michael&apos;, &apos;A&apos;, 13),
 (&apos;jane&apos;, &apos;B&apos;, 12),
 (&apos;mike&apos;, &apos;B&apos;, 12),
 (&apos;dave&apos;, &apos;B&apos;, 10)]
</code></pre><p>如果我们对排序有更高的要求，比如在本例中，在按年龄排序之后，我们还希望对年龄相同的同学按照等级进行排序。我们可以这样写<code>key</code></p>
<pre><code>In [38]: students = sorted(students, key=lambda result: (result[2], result[1]), reverse=True)

In [39]: students
Out[39]:
[(&apos;jessey&apos;, &apos;C&apos;, 15),
 (&apos;john&apos;, &apos;A&apos;, 15),
 (&apos;michael&apos;, &apos;A&apos;, 13),
 (&apos;jane&apos;, &apos;B&apos;, 12),
 (&apos;mike&apos;, &apos;B&apos;, 12),
 (&apos;dave&apos;, &apos;B&apos;, 10)]
</code></pre><p><a href="http://stackoverflow.com/questions/4233476/sort-a-list-by-multiple-attributes" target="_blank" rel="external">stackoverflow: Sort a list by multiple attributes?</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/06/13/python中定义常量/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="You Wangqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/lufei.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Youmai の Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/06/13/python中定义常量/" itemprop="url">python中定义常量</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-06-13T14:25:03+08:00">
                2015-06-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index">
                    <span itemprop="name">python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>实际开发中我们经常会碰到需要定义常量的情形，c语言提供了const关键字来实现，但是python本身却没有提供const，要想在python代码中定义常量，需要我们自己来实现。</p>
<p>下面定义一个const类。要求符合<strong>“命名全部为大写”</strong>和<strong>“值一旦绑定便不可再修改”</strong>这两个条件。<a href="https://github.com/michaelyou/useful-python-code/tree/master/const" target="_blank" rel="external">代码</a></p>
<pre><code>class const(object):
    class ConstError(TypeError): 
        pass
    class ConstCaseError(ConstError):
        pass

    def __setattr__(self, name, value):
        if self.__dict__.has_key(name):
            raise self.ConstError, &quot;can&apos;t change const.%s&quot; % name
        if not name.isupper():
            raise self.ConstCaseError, &quot;const name &apos;%s&apos; is not all uppercase&quot; % name

        self.__dict__[name] = value

import sys
sys.modules[__name__] = const()
</code></pre><p>这里通过对常量对应的值进行修改时或者命名不符合规范时抛出异常来满足以上常量的两个条件。</p>
<p>###NOTE</p>
<p>使用sys.modules[name]可以获取一个模块对象，并可以通过该对象获取模块的属性，这儿使用了sys.modules向系统字典注入了一个const对象从而实现了在执行import const时实际获取了一个const实例的功能，sys.module在文档中的描述如下：</p>
<blockquote>
<p>sys.modules</p>
<p>This is a dictionary that maps module names to modules which have already been loaded. This can be manipulated to force reloading of modules and other tricks. Note that removing a module from this dictionary is not the same as calling reload() on the corresponding module object.</p>
</blockquote>
<p>sys.modules[name] = const()这行代码将系统已经加载的模块列表中的const替换为了const()，即一个const实例</p>
<p>##使用<br>整个工程需要使用的常量都应该定义在一个文件中。例如你将const.py放在了project.utils目录下，常量被定义在project.apps目录下的project_consts.py文件中，那么应该这么写：</p>
<pre><code>#project_consts.py
from project.utils import const

const.NAME = &apos;IBM&apos;
const.EMAIL = &apos;ibm.com&apos;
</code></pre><p>在其他文件中需要使用这些常量时，用如下方式调用：</p>
<pre><code>from project.apps.project_consts import const

print const.NAME
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/06/09/no-module-named-xxx/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="You Wangqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/lufei.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Youmai の Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/06/09/no-module-named-xxx/" itemprop="url">no module named xxx</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-06-09T09:17:52+08:00">
                2015-06-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index">
                    <span itemprop="name">python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>python的常见错误，意思非常明确，这个模块找不到了。导致的原因也很确定：</p>
<ol>
<li>确实没有安装这个模块</li>
<li>路径不对</li>
</ol>
<p>第一个把模块安装上就完事了，第二个往往是导致这个错误最常见的原因。</p>
<p>如果你能确定你已经安装了这个模块，那肯定是import的路径有问题。import导入时，搜索的路径是有顺序的，查看当前python导入模块的搜索路径，可以在交互命令行中执行下面的命令：</p>
<pre><code>In [1]: import sys

In [2]: sys.path
Out[2]:
[&apos;&apos;,
 &apos;/System/Library/Frameworks/Python.framework/Versions/2.7/bin&apos;,
 &apos;/Library/Frameworks/Python.framework/Versions/2.7/lib/python27.zip&apos;,
 &apos;/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7&apos;,
 &apos;/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-darwin&apos;,
 &apos;/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-mac&apos;,
 &apos;/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-mac/lib-scriptpackages&apos;,
 &apos;/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-tk&apos;,
 &apos;/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-old&apos;,
 &apos;/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-dynload&apos;,
 &apos;/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages&apos;,
 &apos;/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/PIL&apos;,
 &apos;/Library/Python/2.7/site-packages&apos;,
 &apos;/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/IPython/extensions&apos;,
 &apos;/Users/youwangqiu/.ipython&apos;]
</code></pre><p>可以看到，我使用的python是现在当前路径(<code>&#39; &#39;</code>)下搜索，然后去系统的各个路径下搜索。而这个机制将<strong>导致一个很大的问题</strong>。</p>
<p>##不要乱给你的<code>.py</code>文件命名<br>你写了一个比较大的应用，多个<code>.py</code>文件，相互之间有<code>import</code>。给这些.py文件取名是件麻烦事，一般都是根据文件的功能来取名的嘛。所以你就将一个进行http请求的文件命名成了<code>requests.py</code>（同时，你的应用需要系统的<code>requests</code>模块）。调试整个应用的时候，你发现，这个<code>requests</code>模块怎么和教程上的不一样啊，怎么该有的函数都没有啊，要你有什么卵用！</p>
<p><code>requests</code>模块说：怪我喽…</p>
<p>大哥，你导入的不是系统的<code>requests</code>模块啊，你导入的是你的<code>requests.py</code>啊，当然什么都没有了。</p>
<p>这里虽然没有报<code>no module named</code>的错误，但是这个错误更难调试，和<code>no module named xxx</code>师出同源，如果你导入的requests模块下的一个函数或类的话，<code>no module named xxx</code>就出现了。</p>
<p>所以说给文件命名之前先考虑清楚，不要潇洒地随便写，不然你就是自己挖坑自己跳。</p>
<p>如果你发现自己确实犯了这个错误，并且改了文件名，请千万记住，还要<strong>把当前目录下相应的<code>.pyc</code>删除掉</strong>，不然还是没用，至于为什么，请自行参考任何一本python教程。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/06/05/django-高效更新数据库/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="You Wangqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/lufei.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Youmai の Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/06/05/django-高效更新数据库/" itemprop="url">Django-高效更新数据库</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-06-05T17:58:54+08:00">
                2015-06-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Django/" itemprop="url" rel="index">
                    <span itemprop="name">Django</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>模型的<code>save()</code>方法，这个方法会更新一行里的所有列。 而某些情况下，我们只需要更新行里的某几列。</p>
<p>例如说我们现在想要将<code>Apress Publisher</code>的名称由原来的<code>”Apress”</code>更改为<code>”Apress Publishing”</code>。若使用<code>save()</code>方法，如：</p>
<pre><code>&gt;&gt;&gt; p = Publisher.objects.get(name=&apos;Apress&apos;)
&gt;&gt;&gt; p.name = &apos;Apress Publishing&apos;
&gt;&gt;&gt; p.save()
</code></pre><p>这等同于如下SQL语句：</p>
<pre><code>SELECT id, name, address, city, state_province, country, website
FROM books_publisher
WHERE name = &apos;Apress&apos;;

UPDATE books_publisher SET
    name = &apos;Apress Publishing&apos;,
    address = &apos;2855 Telegraph Ave.&apos;,
    city = &apos;Berkeley&apos;,
    state_province = &apos;CA&apos;,
    country = &apos;U.S.A.&apos;,
    website = &apos;http://www.apress.com&apos;
WHERE id = 52;
（注意在这里我们假设Apress的ID为52）
</code></pre><p>在这个例子里我们可以看到<strong>Django的save()方法更新了不仅仅是name列的值，还有更新了所有的列</strong>。 若name以外的列有可能会被其他的进程所改动的情况下，只更改name列显然是更加明智的。 更改某一指定的列，我们可以调用结果集（QuerySet）对象的update()方法： 示例如下：</p>
<pre><code>&gt;&gt;&gt; Publisher.objects.filter(id=52).update(name=&apos;Apress Publishing&apos;)
</code></pre><p>与之等同的SQL语句变得更高效，并且不会引起竞态条件。</p>
<pre><code>UPDATE books_publisher
SET name = &apos;Apress Publishing&apos;
WHERE id = 52;
</code></pre><p><code>update()</code>方法对于任何结果集（<code>QuerySet</code>）均有效，这意味着你可以同时更新多条记录。 以下示例演示如何将所有<code>Publisher</code>的<code>country</code>字段值由<code>’U.S.A’</code>更改为<code>’USA’</code>：</p>
<pre><code>&gt;&gt;&gt; Publisher.objects.all().update(country=&apos;USA&apos;)
2
</code></pre><p>update()方法会返回一个整型数值，表示受影响的记录条数。 在上面的例子中，这个值是2。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/06/05/丢失私有密钥时连接到虚拟机-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="You Wangqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/lufei.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Youmai の Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/06/05/丢失私有密钥时连接到虚拟机-2/" itemprop="url">丢失私有密钥时连接到虚拟机(2)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-06-05T13:34:45+08:00">
                2015-06-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/openstack/" itemprop="url" rel="index">
                    <span itemprop="name">openstack</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>原理和<a href="http://michaelyou.github.io/2015/06/02/%E4%B8%A2%E5%A4%B1%E7%A7%81%E6%9C%89%E5%AF%86%E9%92%A5%E6%97%B6%E8%BF%9E%E6%8E%A5%E5%88%B0%E8%99%9A%E6%8B%9F%E6%9C%BA/" target="_blank" rel="external">丢失私有密钥时连接到虚拟机(1)</a>是一样的，从镜像创建的虚拟机我们也可以将其挂载到别的机器上，只是需要的命令不同。</p>
<p>##具体步骤</p>
<ul>
<li>关闭你的虚拟机</li>
<li>找到你的虚拟机的<code>id</code>，类似<code>282d0355-a4db-4467-a70b-4783ac2c7ed6</code>这样一串数字</li>
<li>找到你的虚拟机的宿主机，登录到宿主机上</li>
<li><p>进入到存放虚拟机文件的目录</p>
<pre><code>cd /var/lib/nova/instances/{id}
</code></pre><p>这里的<code>id</code>就是你上面虚拟机的<code>id</code><br>这个目录下的内容是这样的</p>
<pre><code>.
├── console.log
├── disk
├── disk.info
├── libvirt.xml
</code></pre><p>这里的disk文件就是我们要操作的对象</p>
</li>
<li><p>在当前目录下创建sysroot目录</p>
<pre><code>mkdir sysroot
</code></pre></li>
<li><p>挂载disk文件到本机</p>
<pre><code>guestmount -a disk --rw -m /dev/sda1  sysroot
</code></pre><p><strong>Note</strong>：如果你是ubuntu的系统，guestmount会报错如下：</p>
<pre><code>libguestfs: error: /usr/bin/supermin-helper exited with error status 1.
To see full error messages you may need to enable debugging.
See http://libguestfs.org/guestfs-faq.1.html#debugging-libguestfs
</code></pre><p>这个时候你可以执行：</p>
<pre><code>update-guestfs-appliance
</code></pre></li>
<li><p>进入sysroot并把它当作当前进程的根文件系统</p>
<pre><code>cd sysroot; chroot .
</code></pre></li>
<li><p>现在就可以修改虚拟机的文件啦！        </p>
</li>
<li><p>修改完成后，exit退出chroot的环境</p>
<pre><code>exit
cd ..  #回到上一级目录
umount sysroot
</code></pre></li>
<li><p>启动虚拟机即可</p>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/17/">17</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/img/lufei.jpeg"
               alt="You Wangqiu" />
          <p class="site-author-name" itemprop="name">You Wangqiu</p>
           
              <p class="site-description motion-element" itemprop="description">世之奇伟、瑰怪，非常之观，常在于险远，而人之所罕至焉，故非有志者不能至也</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">163</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">25</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">31</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/michaelyou" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                    
                      GitHub
                    
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.zhihu.com/people/zhi-yu-65-2" target="_blank" title="知乎">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                    
                      知乎
                    
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="michaelseu2011@gmail.com" target="_blank" title="E-Mail">
                  
                    <i class="fa fa-fw fa-envelope"></i>
                  
                    
                      E-Mail
                    
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">You Wangqiu</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  

  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  






  





  

  

  

  

  

  

</body>
</html>
