<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/img/lufei.ico?v=5.1.2" />






<meta name="description" content="世之奇伟、瑰怪，非常之观，常在于险远，而人之所罕至焉，故非有志者不能至也">
<meta property="og:type" content="website">
<meta property="og:title" content="Youmai の Blog">
<meta property="og:url" content="http://yoursite.com/page/3/index.html">
<meta property="og:site_name" content="Youmai の Blog">
<meta property="og:description" content="世之奇伟、瑰怪，非常之观，常在于险远，而人之所罕至焉，故非有志者不能至也">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Youmai の Blog">
<meta name="twitter:description" content="世之奇伟、瑰怪，非常之观，常在于险远，而人之所罕至焉，故非有志者不能至也">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"right","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/3/"/>





  <title>Youmai の Blog</title>
  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-63551049-1', 'auto');
  ga('send', 'pageview');
</script>





</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-right 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Youmai の Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/07/22/Django-统计查询/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="You Wangqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/lufei.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Youmai の Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/07/22/Django-统计查询/" itemprop="url">Django-统计查询</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-07-22T19:24:08+08:00">
                2015-07-22
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Django/" itemprop="url" rel="index">
                    <span itemprop="name">Django</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>##统计<br><a href="http://docs.oneele.com/django/topics/db/queries.html" target="_blank" rel="external">Django 数据库抽象 API</a> 描述了如何创建、检索、更新和删除独立的对象。但是，有时你会需要处理一些有关对象的集合的统计。本文描述如何使用 Django 查询来处理统计。<br>本文我们将使用以下模型。这些模型用于在线书店图书清单：</p>
<pre><code>class Author(models.Model):
   name = models.CharField(max_length=100)
   age = models.IntegerField()
   friends = models.ManyToManyField(&apos;self&apos;, blank=True)

class Publisher(models.Model):
   name = models.CharField(max_length=300)
   num_awards = models.IntegerField()

class Book(models.Model):
   isbn = models.CharField(max_length=9)
   name = models.CharField(max_length=300)
   pages = models.IntegerField()
   price = models.DecimalField(max_digits=10, decimal_places=2)
   rating = models.FloatField()
   authors = models.ManyToManyField(Author)
   publisher = models.ForeignKey(Publisher)
   pubdate = models.DateField()

class Store(models.Model):
   name = models.CharField(max_length=300)
   books = models.ManyToManyField(Book)
</code></pre><p>##生成整个查询集的统计<br>Django 提供两种方法来产生统计。第一种方法是产生整个 查询集 的统计。假设我们要统计所有书的平均价格。 Djnago 中查询所有书的语句为:</p>
<pre><code>&gt;&gt;&gt; Book.objects.all()
</code></pre><p>在这个语句后加上一个 <code>aggregate()</code> 子句就行了:</p>
<pre><code>&gt;&gt;&gt; from django.db.models import Avg
&gt;&gt;&gt; Book.objects.all().aggregate(Avg(&apos;price&apos;))
{&apos;price__avg&apos;: 34.35}
</code></pre><p>上例中的 <code>all()</code> 是多余的。所以可以简写为:</p>
<pre><code>&gt;&gt;&gt; Book.objects.aggregate(Avg(&apos;price&apos;))
{&apos;price__avg&apos;: 34.35}
</code></pre><p><code>aggregate()</code>子句的参数代表我们要统计的内容，本例中我们要统计 Book 模型中 <code>price</code> 字段的平均值。 查询集参考 中可以找到完整的统计函数列表。<br><code>aggregate()</code>是一个 查询集 的未端子句，调用后会返回一个由名称－值配对组成的字典。名称是指统计的名称，值就是统计的值。名称由字段名称加上函数名自动组成。如果你想手动指定统计名称，可以象下例在统计子句中定义:</p>
<pre><code>&gt;&gt;&gt; Book.objects.aggregate(average_price=Avg(&apos;price&apos;))
{&apos;average_price&apos;: 34.35}
</code></pre><p>如果你想要生成多个统计，那么只要在统计子句后加上另外的统计子句就可以了。例如，如果要计算所有书价中最高价和最低价，可以这样写:</p>
<pre><code>&gt;&gt;&gt; from django.db.models import Avg, Max, Min, Count
&gt;&gt;&gt; Book.objects.aggregate(Avg(&apos;price&apos;), Max(&apos;price&apos;), Min(&apos;price&apos;))
{&apos;price__avg&apos;: 34.35, &apos;price__max&apos;: Decimal(&apos;81.20&apos;), &apos;price__min&apos;: Decimal(&apos;12.99&apos;)}
</code></pre><p>##生成查询集中每一个项目的统计<br>第二种方法是为 查询集 中每个独立的对象生成统计。例如，当你检索一个书单时，可能想知道每本书有几个作者。每本书与每个作者之间是一个多对多的关系，我们要为每本书总结这个关系。</p>
<p>要产生每个对象的统计可以使用 <code>annotate()</code> 子句。当定义一个 <code>annotate()</code> 子句后， 查询集 中的每个对象就可以与特定值关联，相当于每个对象有一个 “注释”。<br>这种注释的语法与 <code>aggregate()</code> 相同。 <code>annotate()</code> 的每个参数代表一个统计。例如，要计算每本书的作者人数:</p>
<pre><code># Build an annotated queryset
&gt;&gt;&gt; q = Book.objects.annotate(Count(&apos;authors&apos;))
# Interrogate the first object in the queryset
&gt;&gt;&gt; q[0]
&lt;Book: The Definitive Guide to Django&gt;
&gt;&gt;&gt; q[0].authors__count
2
# Interrogate the second object in the queryset
&gt;&gt;&gt; q[1]
&lt;Book: Practical Django Projects&gt;
&gt;&gt;&gt; q[1].authors__count
1
</code></pre><p>和 <code>aggregate()</code> 一样，统计的名称自动由字段名和函数名组成。你也可以在定义统计时指定名称:</p>
<pre><code>&gt;&gt;&gt; q = Book.objects.annotate(num_authors=Count(&apos;authors&apos;))
&gt;&gt;&gt; q[0].num_authors
2
&gt;&gt;&gt; q[1].num_authors
1
</code></pre><p>与 <code>aggregate()</code> 不同的是, <code>annotate()</code> 不是 一个未端子句。 <code>annotate()</code> 子句的输出是一个 查询集 。 这个 查询集 可以和其他查询集一样操作，包括 <code>filter()</code> 、 <code>order_by</code> 或者甚至再调用另一个 <code>annotate()</code> 。</p>
<p>##联合和统计<br>至此，我们统计的对象都是被查询的模块本身的字段。但是，有时我们要统计的是被查询模块的相关联的模块字段。<br>在统计函数中定义字段时，可以使用与过滤器中用于指定关联字段的 双下划线符号 。通过这种方法， Django 会自动使用联合来统计相关联的字段。</p>
<p>例如，要统计每个书店中书的价格范围:</p>
<pre><code>&gt;&gt;&gt; Store.objects.annotate(min_price=Min(&apos;books__price&apos;), max_price=Max(&apos;books__price&apos;))
</code></pre><p>上面的例子告诉 Django 检索 Store 模型，联合（通过多对多关系） Book 模型，并且统计 book 模型中的价格字段，计算最大值和最小值。<br><code>aggergate()</code> 子句适用同样规则。如果你想知道所有书店中书的最高价和最低价，可以这样:</p>
<pre><code>&gt;&gt;&gt; Store.objects.aggregate(min_price=Min(&apos;books__price&apos;), max_price=Max(&apos;books__price&apos;))
</code></pre><p>联合的深度是无限的。例如，要统计所有书的作者的最小年龄，你可以这样:</p>
<pre><code>&gt;&gt;&gt; Store.objects.aggregate(youngest_age=Min(&apos;books__authors__age&apos;))
</code></pre><p>##统计和其他查询子句</p>
<p>###<code>filter()</code> 和 <code>exclude()</code><br>在过滤器中也可以使用统计。任何用于一般模型的 <code>filter()</code> （或 <code>exclude()</code> ）也可与统计联用。</p>
<p>当与 <code>annotate()</code> 子句联用时，过滤器作用于被统计的对象上。例如要统计书名以 “Django” 开头的书:</p>
<pre><code>&gt;&gt;&gt; Book.objects.filter(name__startswith=&quot;Django&quot;).annotate(num_authors=Count(&apos;authors&apos;))
</code></pre><p>当与 <code>aggregate()</code> 子句联用时，过滤器作用于被统计的所有对象上。例如要统计书名以 “Django” 开头的书的平均价格:</p>
<pre><code>&gt;&gt;&gt; Book.objects.filter(name__startswith=&quot;Django&quot;).aggregate(Avg(&apos;price&apos;))
</code></pre><p>###过滤统计的值<br>统计出来的值也可以被过滤。和其他模型一样，统计的结果也可以使用 <code>filter()</code> 和 <code>exclude()</code> 子句来过滤。</p>
<p>例如，要产生一个由两个以上作者的书单可以这样:</p>
<pre><code>&gt;&gt;&gt; Book.objects.annotate(num_authors=Count(&apos;authors&apos;)).filter(num_authors__gt=1)
</code></pre><p>上例先进行统计，然后在统计的结果上使用了过滤器。</p>
<p>###<code>annotate()</code> 和 <code>filter()</code> 子句的顺序<br>当使用同时包含 <code>annotate()</code> 和 <code>filter()</code> 子句的复杂查询时，要特别小心两种子句的顺序。</p>
<p>当一个 <code>annotate()</code> 子句作用于查询时，该统计只对子句之前的查询起作用。也就是说 <code>filter()</code> 和 <code>annotate()</code> 顺序不同，查询就不同了。查询:</p>
<pre><code>&gt;&gt;&gt; Publisher.objects.annotate(num_books=Count(&apos;book&apos;)).filter(book__rating__gt=3.0)
</code></pre><p>和查询:</p>
<pre><code>&gt;&gt;&gt; Publisher.objects.filter(book__rating__gt=3.0).annotate(num_books=Count(&apos;book&apos;))
</code></pre><p>是不同的。两个查询都会返回至少有一本好书（评分大于 3.0 ）的出版商。但是，第一个查询中的统计会提供出版商的所有书的数量；第二个查询中的统计只返回好书的数量。第一个查询中统计先于过滤器，所以过滤器对统计没有作用。而第二个查询过滤器先于统计，所以统计的对象是已经过滤过的。</p>
<p>###order_by()<br>统计可以作为排序的基础。当你定义一个 <code>order_by</code> 子句时，可以引用 <code>annotate()</code> 子句中的统计。</p>
<p>例如，要依据书的作者人数进行排序，可以这样:</p>
<pre><code>&gt;&gt;&gt; Book.objects.annotate(num_authors=Count(&apos;authors&apos;)).order_by(&apos;num_authors&apos;)
</code></pre><p>###values()<br>通常,统计会针对 查询集 中每一个对象返回一个结果。但是，当使用 <code>values</code> 子句来约束要统计的列时，返回的结果会有所不同。原先统计结果中，统计字段的值相同的项会分组合并统计。<br>例如，要统计每个作者各自所写的书的平均评分:</p>
<pre><code>&gt;&gt;&gt; Author.objects.annotate(average_rating=Avg(&apos;book__rating&apos;))
</code></pre><p>返回的结果会包含每一个作者及其所写的书的平均计分。</p>
<p>但是，如果使用 <code>values()</code> 子句，返回的结果会有所不同:</p>
<pre><code>&gt;&gt;&gt; Author.objects.values(&apos;name&apos;).annotate(average_rating=Avg(&apos;book__rating&apos;))
</code></pre><p>这个例子中会把作者按名字分组统计，返回的结果中不会有重复的作者名字。名字相同的作者在统计中会作为同一个作者来统计，同名作者所写的书的评分会合并为一个作者的书来统计。</p>
<p>###<code>annotate()</code> 和 <code>values()</code> 子句的顺序<br>当使用 <code>filter()</code> 子句时， <code>annotate()</code> 和 <code>values()</code> 子句的顺序是非常重要的。如果 <code>values()</code> 子句先于 <code>annotate()</code> 子句，会按照前文所述的方式统计。</p>
<p>但是，如果 <code>annotate()</code> 子句先于 <code>values()</code> 子句，那么统计会作用于整个查询集，而 <code>values()</code> 子句只约束统计输出的字段。</p>
<p>例如，如果我们把前一个例子中的 <code>values()</code> 和 <code>annotate()</code> 子句调换顺序:</p>
<pre><code>&gt;&gt;&gt; Author.objects.annotate(average_rating=Avg(&apos;book__rating&apos;)).values(&apos;name&apos;, &apos;average_rating&apos;)
</code></pre><p>这个例子会为每一个作者生成唯一的结果。但是在输了的数据中只会包含作者名和 <code>average_rating</code> 的统计。</p>
<p>你可以注意到 <code>average_rating</code> 在例子中显示地定义了。在 <code>annotate()</code> 和 <code>values()</code> 子句的顺序处于这种情况是必须显式定义。</p>
<p>如果 <code>values()</code> 子句先于 <code>annotate()</code> 子句，那么任何统计会自动添加到输出结果中。但是 <code>values()</code> 子句在 <code>annotate()</code> 子句之后，那么必须显式定义统计列。</p>
<p>###缺省排序或 order_by() 子句的副作用<br>一个查询集中 <code>order_by()</code> 子句中的字段（或一个模型中缺省排序字段）会对输了数据产生影响，即使在 <code>values()</code> 中没有这些字段的定义时也同样会影响。这些特殊的字段会影响统计结果,这种情况在计数统计时尤为明显。</p>
<p>假设有一个这样的模型:</p>
<pre><code>class Item(models.Model):
    name = models.CharField(max_length=10)
    data = models.IntegerField()

    class Meta:
        ordering = [&quot;name&quot;]
</code></pre><p>这里的重点是作为缺省排序的 name 字段。如果你想要统计不重复的 data 值出现了多少次，你可能会使用如下语句:</p>
<pre><code># 警告：这个语句不完全正确！
Item.objects.values(&quot;data&quot;).annotate(Count(&quot;id&quot;))
</code></pre><p>…这个语句看似会根据 data 值分组统计 Item 对象的 id 。但统计结果中 name 字段也会参与其中，所以这个语句实际的是不重复的 <code>(data, name)</code> 配对，而这不是我们所要的结果，因此我们应当这样统计:</p>
<pre><code>Item.objects.values(&quot;data&quot;).annotate(Count(&quot;id&quot;)).order_by()
</code></pre><p>…这里我们通过一个空的<code>“ order_by() ”</code>来清除副作用。</p>
<p>这个行为与在查询集文档中 <code>distinct()</code> 提到的一样。通常的规则是：当你不想要额外的字段在统计结果中产生作用时，必须清空排序的内容或者至少确认 <code>values()</code> 子句中的字段已经限制了这些额外字段。</p>
<p>####Note<br>你可以会问为什么 Django 不去除这些字段的影响。主要的原因是为维护 <code>distinct()</code> 的一贯性和一个原则： Django 从不 删除你的排序定义（我们不会改变那么模型方法的行为，否则就会违背我们 <a href="http://docs.oneele.com/django/misc/api-stability.html" target="_blank" rel="external">API stability</a> 策略）。</p>
<p>###对小计进行统计<br>你可以对小计的结果进行统计。在查询中，你可以使用 <code>aggregate()</code> 子句来对 <code>annotate()</code>的结果进行统计。</p>
<p>例如，假设你要统计每本书的作者人数的平均值，那么首先要计算每本书的作者人数，然后根据这个结果来统计平均值:</p>
<pre><code>&gt;&gt;&gt; Book.objects.annotate(num_authors=Count(&apos;authors&apos;)).aggregate(Avg(&apos;num_authors&apos;))
{&apos;num_authors__avg&apos;: 1.66}
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/07/19/python排序函数/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="You Wangqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/lufei.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Youmai の Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/07/19/python排序函数/" itemprop="url">python排序函数</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-07-19T21:38:15+08:00">
                2015-07-19
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index">
                    <span itemprop="name">python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>##sort和sorted<br>相比于<code>sort</code>，<code>sorted()</code>的使用更为广泛</p>
<pre><code>sorted(iterable, cmp, key, reverse)
s.sort(cmp, key, reverse)
</code></pre><p><code>sorted</code>可以作用域任意迭代对象，而<code>sort()</code>一般作用于列表。</p>
<p><code>reverse = True</code>表示按照逆序排序</p>
<p>##sorted</p>
<p><code>sorted</code>排序的关键是传入<code>key</code>：</p>
<pre><code>In [35]: students = [(&apos;john&apos;, &apos;A&apos;, 15), (&apos;jane&apos;, &apos;B&apos;, 12), (&apos;dave&apos;, &apos;B&apos;, 10), (&apos;michael&apos;, &apos;A&apos;, 13), (&apos;mike&apos;, &apos;B&apos;, 12), (&apos;jessey&apos;, &apos;C&apos;, 15)]

In [36]: students = sorted(students, key=lambda result: result[2], reverse=True)
</code></pre><p>结果：</p>
<pre><code>In [37]: students
Out[37]:
[(&apos;john&apos;, &apos;A&apos;, 15),
 (&apos;jessey&apos;, &apos;C&apos;, 15),
 (&apos;michael&apos;, &apos;A&apos;, 13),
 (&apos;jane&apos;, &apos;B&apos;, 12),
 (&apos;mike&apos;, &apos;B&apos;, 12),
 (&apos;dave&apos;, &apos;B&apos;, 10)]
</code></pre><p>如果我们对排序有更高的要求，比如在本例中，在按年龄排序之后，我们还希望对年龄相同的同学按照等级进行排序。我们可以这样写<code>key</code></p>
<pre><code>In [38]: students = sorted(students, key=lambda result: (result[2], result[1]), reverse=True)

In [39]: students
Out[39]:
[(&apos;jessey&apos;, &apos;C&apos;, 15),
 (&apos;john&apos;, &apos;A&apos;, 15),
 (&apos;michael&apos;, &apos;A&apos;, 13),
 (&apos;jane&apos;, &apos;B&apos;, 12),
 (&apos;mike&apos;, &apos;B&apos;, 12),
 (&apos;dave&apos;, &apos;B&apos;, 10)]
</code></pre><p><a href="http://stackoverflow.com/questions/4233476/sort-a-list-by-multiple-attributes" target="_blank" rel="external">stackoverflow: Sort a list by multiple attributes?</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/06/30/HTML5与CSS3基础教程/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="You Wangqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/lufei.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Youmai の Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/06/30/HTML5与CSS3基础教程/" itemprop="url">《HTML5与CSS3基础教程》</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-06-30T14:21:36+08:00">
                2015-06-30
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/web/" itemprop="url" rel="index">
                    <span itemprop="name">web</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>##HTML</p>
<ol>
<li>html文件的文件名全部使用小写字母，用短横线分割单词</li>
<li>a = anchor(锚)</li>
<li>每个浏览器都有一个内置的CSS文件，它决定了每个HTML元素的默认样式。你自己创建的CSS可以覆盖这些样式。</li>
<li>small元素表示的含义是法律声明等条文细则</li>
<li>header用于创建页眉，通常情况下，页眉包括网站标志，主导航和其他全站链接，甚至搜索框。只在必要时使用header。大多数情况下，如果h1~h6能满足要求，就没有必要用header将其包起来。</li>
<li>main是HTML5新添加的元素，包围着代表页面主题的内容，在一个页面里仅使用一次</li>
<li>article是HTML5新增元素。内容可以包含任意数量的元素。元素类型包括段落，列表，音频，视频，图像，图形等</li>
<li>aside是HTML5的新增元素。用于页面的附注栏。内容可以包含任意数量的元素。元素类型包括段落，列表，音频，视频，图，图形等。</li>
<li>HTML5中引入了大量新的标签，很多就是为了取代div。在HTML5中，div并没有消失，只是使用它的场合变少了。P55</li>
<li>cite元素用于标识对艺术作品，电影，图书等内容的引用</li>
<li>strong标记重要文本，em标记想要强调的文本</li>
<li>blockquote用于标记引述的文本 P70</li>
<li>abbr元素标记缩写词并解释其含义</li>
<li>dfn标记要定义的术语</li>
<li>sub创建下标，sup创建上标</li>
<li>del标记已删除内容(在内容上划线)</li>
<li>mark标记是荧光笔效果，用于突出显示文本</li>
<li>span –P88</li>
</ol>
<p>##表单</p>
<ol>
<li>表单中的每个控件都有一个name属性，用于提交表单时对数据进行识别</li>
<li>有的表单元素有内置的验证功能，有的网站使用javascript进行验证，这些都不能完全代替服务器端的验证，因为旧的浏览器或完全禁用javascript的浏览器不会执行客户端验证。</li>
<li>分隔表单元素可以使用p和div</li>
<li>为表单添加标签。label元素有一个特殊的属性：for。如果for的值域一个表单字段的id值相同，该label就与该字段显式地关联起来了。这对提升表单的可用性和可访问性都有帮助。–P330</li>
<li>单选按钮中的value属性的值，在该按钮被选中提交后，将会提交给服务器。</li>
<li>访问者输入的信息不发送到服务器就没什么用。应该总是为表单创建提交按钮，让访问者将信息交给你。submit–P343</li>
<li></li>
</ol>
<p>##CSS</p>
<ol>
<li>注释写在<code>/*  */</code>中</li>
<li>当你为某个元素应用CSS属性时，这些属性不仅会影响该元素，还会影响其下的分支元素。也就是说，这些下层的元素继承了其祖先元素的属性</li>
<li>哪些属性会被继承–P128</li>
<li>按类或ID选择元素， 类用<code>.</code>(点号)，ID用<code>#</code>(井号)</li>
<li>创建斜体：<code>font-style:italic</code>  –P176</li>
<li>应用粗体：<code>font-weight:bold</code> –P177</li>
<li>设置行高：<code>line-height:xxx</code></li>
</ol>
<p>##用CSS进行布局</p>
<ol>
<li>CSS让页面富有活力，但是首先我们应该知道，高校网页的核心是结构良好，语义化的HTML</li>
<li>盒模型–P211，209<ul>
<li>内容区域</li>
<li>内容区域周围的空间（内边距–padding）</li>
<li>内边距的外边缘（边框–border）</li>
<li>边框外面将元素与相邻元素隔开的不可见区域（外边距–margin）</li>
</ul>
</li>
<li>设置边框–P219</li>
<li>让文本环绕元素–设置浮动。分栏就是这么设计的</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/06/30/JavaScript-DOM编程艺术/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="You Wangqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/lufei.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Youmai の Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/06/30/JavaScript-DOM编程艺术/" itemprop="url">《JavaScript DOM编程艺术》</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-06-30T14:19:00+08:00">
                2015-06-30
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/JavaScript/" itemprop="url" rel="index">
                    <span itemprop="name">JavaScript</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ol>
<li>javascript语言的另两个名字是ECMAScript和JScript，它们都是同一种语言，随便你怎么称呼它。</li>
</ol>
<ul>
<li>DOM = Document Object Model = 文档对象模型</li>
<li>在js中，在每条语句的后面加上一个<code>;</code>，是一种良好的编程习惯。</li>
<li>js允许程序员直接对变量赋值而无需事先声明，但是提前声明是一种良好的编程习惯</li>
<li>Javascript 的数组<code>Array</code>,既是一个<strong>数组</strong>，也是一个<strong>字典</strong><code>(Dictionary)</code></li>
<li>js支持<code>++</code>和<code>+=</code>操作符，python不支持<code>++</code></li>
<li>js支持三元操作符<code>a?b:c</code>, python不支持</li>
<li>在几乎所有浏览器里，用<code>Tab</code>键移动到某个链接然后按下回车键的动作也会触发<code>onclick</code>事件</li>
<li>HTML DOM提供了很多属性，可以让我们更方便地处理网页(P93).</li>
<li>把新创建的节点插入某个文档的节点树的最简单的方法是，让他成为这个文档某个现有节点的一个子节点</li>
<li>DOM提供了insertBefore方法，但是没有提供insertAfter方法。但我们可以自己编写insertAfter方法(P110).</li>
<li>到目前为止，各大搜索引擎网站的搜索机器人还几乎不支持javascript</li>
</ul>
<p>##变量作用域<br>如果在某个函数中使用了var，那个变量就会被视为一个全局变量，它只存在于这个函数的上下文中；反之，如果没有使用var，那个变量就会被视为一个全局变量，如果脚本里已经存在一个与之同名的全局变量，这个函数就会改变那个全局变量的值。</p>
<p>##js文档放在哪里最好<br>最好的做法是把<code>&lt;script&gt;</code>标签放在<code>HTML</code>文档的最后，<code>&lt;/body&gt;</code>标签之前，这样能使浏览器更快地加载页面。</p>
<p>##在页面加载完毕后执行函数<br>最佳的解决方法是编写<code>addLoadEvent</code>方法(P83)，这个函数将会把那些在页面加载完毕时执行的函数创建为一个队列。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/06/30/jQuery选择器中的空格/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="You Wangqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/lufei.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Youmai の Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/06/30/jQuery选择器中的空格/" itemprop="url">jQuery选择器中的空格</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-06-30T11:23:25+08:00">
                2015-06-30
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/jQuery/" itemprop="url" rel="index">
                    <span itemprop="name">jQuery</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#jQuery选择器中的空格<br>来自–《锋利的jQuery》</p>
<p>选择器中的空格是不容忽视的，多一个空格或少一个空格也许得到的结果会截然不同的。下面来看一个例子。</p>
<p>HTML代码如下：</p>
<pre><code>&lt;div class=&quot;test&quot;&gt;
&lt;div style=&quot;display:none;&quot;&gt;Jquery教程&lt;/div&gt;
&lt;div style=&quot;display:none;&quot;&gt;Jquery学习&lt;/div&gt;
&lt;div style=&quot;display:none;&quot;&gt;Jquery插件&lt;/div&gt;
&lt;div class=&quot;test&quot; style=&quot;display:none;&quot;&gt;PHP学习&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;test&quot; style=&quot;display:none;&quot;&gt;Jquery插件教程&lt;/div&gt;
&lt;div class=&quot;test&quot; style=&quot;display:none;&quot;&gt;Jquery插件学习&lt;/div&gt;
</code></pre><p>使用如下jQuery代码获取它们：</p>
<pre><code>var $test_a = $(&quot;.test :hidden&quot;);//带空格的jQuery选择器
var $test_b = $(&quot;.test:hidden&quot;);//不带空格的jQuery选择器
var len_a = $test_a.length;
var len_b = $test_b.length;
alert(&quot;带空格的jQuery选择器选出的jQuery元素是：&quot;+len_a+&quot;个&quot;);//输出为4个
alert(&quot;不带空格的jQuery选择器选出的jQuery元素是：&quot;+len_b+&quot;个&quot;);//输出为3个
</code></pre><p>之所以会出现不同的结果，这就是后代选择器和过滤选择器的不同了</p>
<pre><code>var $test_a = $(&quot;.test :hidden&quot;);//带空格的jQuery选择器
</code></pre><p>上面这段代码是选取class为“test”的元素里面的隐藏元素。（后代选择器）</p>
<pre><code>var $test_b = $(&quot;.test:hidden&quot;);//不带空格的jQuery选择器
</code></pre><p>这上面的代码则是选取隐藏的class为“test”的元素</p>
<p>###<strong>注意</strong>:<br>有的选择器的用法，必须是空格，如果不带空格的话，那就取不到元素，比如：</p>
<pre><code>$(&quot;select:selected&quot;).length;//不管任何时候，这个选择器都取不到元素，这个length必然是0
$(&quot;select :selected&quot;);//这样才是正确的
</code></pre><p>有的选择器的用法，必须不带空格，如果带空格的话，那就取不到元素，比如：</p>
<pre><code>$(&quot;input :checked&quot;).length;//不管任何时候，这个选择器都取不到元素，这个length必然是0
$(&quot;input:checked&quot;);//这样才是正确的
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/06/13/python中定义常量/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="You Wangqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/lufei.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Youmai の Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/06/13/python中定义常量/" itemprop="url">python中定义常量</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-06-13T14:25:03+08:00">
                2015-06-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index">
                    <span itemprop="name">python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>实际开发中我们经常会碰到需要定义常量的情形，c语言提供了const关键字来实现，但是python本身却没有提供const，要想在python代码中定义常量，需要我们自己来实现。</p>
<p>下面定义一个const类。要求符合<strong>“命名全部为大写”</strong>和<strong>“值一旦绑定便不可再修改”</strong>这两个条件。<a href="https://github.com/michaelyou/useful-python-code/tree/master/const" target="_blank" rel="external">代码</a></p>
<pre><code>class const(object):
    class ConstError(TypeError): 
        pass
    class ConstCaseError(ConstError):
        pass

    def __setattr__(self, name, value):
        if self.__dict__.has_key(name):
            raise self.ConstError, &quot;can&apos;t change const.%s&quot; % name
        if not name.isupper():
            raise self.ConstCaseError, &quot;const name &apos;%s&apos; is not all uppercase&quot; % name

        self.__dict__[name] = value

import sys
sys.modules[__name__] = const()
</code></pre><p>这里通过对常量对应的值进行修改时或者命名不符合规范时抛出异常来满足以上常量的两个条件。</p>
<p>###NOTE</p>
<p>使用sys.modules[name]可以获取一个模块对象，并可以通过该对象获取模块的属性，这儿使用了sys.modules向系统字典注入了一个const对象从而实现了在执行import const时实际获取了一个const实例的功能，sys.module在文档中的描述如下：</p>
<blockquote>
<p>sys.modules</p>
<p>This is a dictionary that maps module names to modules which have already been loaded. This can be manipulated to force reloading of modules and other tricks. Note that removing a module from this dictionary is not the same as calling reload() on the corresponding module object.</p>
</blockquote>
<p>sys.modules[name] = const()这行代码将系统已经加载的模块列表中的const替换为了const()，即一个const实例</p>
<p>##使用<br>整个工程需要使用的常量都应该定义在一个文件中。例如你将const.py放在了project.utils目录下，常量被定义在project.apps目录下的project_consts.py文件中，那么应该这么写：</p>
<pre><code>#project_consts.py
from project.utils import const

const.NAME = &apos;IBM&apos;
const.EMAIL = &apos;ibm.com&apos;
</code></pre><p>在其他文件中需要使用这些常量时，用如下方式调用：</p>
<pre><code>from project.apps.project_consts import const

print const.NAME
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/06/12/再读the-django-book-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="You Wangqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/lufei.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Youmai の Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/06/12/再读the-django-book-1/" itemprop="url">再读《the Django book》</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-06-12T00:06:56+08:00">
                2015-06-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Django/" itemprop="url" rel="index">
                    <span itemprop="name">Django</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li><p>登录进数据库服务器看Django创建的数据表，除了手动启动命令行客户端，还可以执行</p>
<pre><code>python manage.py dbshell
</code></pre><p>这个命令将依据<code>DATABASE_SERVER</code> 的里设置自动检测使用哪种命令行客户端</p>
</li>
<li><p><strong><code>添加模块的字符串表现</code></strong>，这个讲的就是给模型添加<code>__unicode__()</code>方法，<code>__unicode__()</code>方法告诉python如何将对象以unicode的方式显示出来。</p>
</li>
</ul>
<ul>
<li><p>使用<code>Publisher.objects,all()</code>来选择所有数据时，SQL语句执行的是：</p>
<pre><code>SELECT id, name, address, city, state_province, country, website 
FROM books_publisher;
</code></pre><p>并没有使用 <code>SELECT *</code>，而是<strong>显式列出了所有字段</strong>。 设计的时候就是这样： <code>SELECT *</code> 会更慢，而且最重要的是列出所有字段遵循了Python 界的一个信条： <strong>明言胜于暗示</strong>。</p>
</li>
<li><p>你可以在任意一个模型类中使用 <code>Meta</code> 类，来设置一些与特定模型相关的选项。例如设置<code>ordering</code>这个选项。如果你设置了这个选项，那么除非你检索时特意额外地使用了 <code>order_by()</code>，否则，当你使用 Django 的数据库 API 去检索时，这个模型的对象的相关返回值默认地都会按<code>ordering</code>设置的字段排序。</p>
</li>
<li><p>你需要一段<code>context</code>来解析模板。 一般情况下，这是一个 <code>django.template.Context</code> 的实例，不过在Django中还可以用一个特殊的子类， <code>django.template.RequestContext</code>，这个用起来稍微有些不同。 <code>RequestContext</code> 默认地在模板<code>context</code>中加入了一些变量，如 <code>HttpRequest</code> 对象或当前登录用户的相关信息。</p>
</li>
<li><p>在模板中判断当前是否处在debug模式下，可以启动<code>django.core.context_processors.debug</code>，它返回值中的<code>debug</code>字段就是<code>setting</code>中的<code>debug</code></p>
</li>
<li><p>作为合法的标签库，模块需要包含一个名为<code>register</code>的模块级变量。这个变量是<code>template.Library</code>的实例，是所有注册标签和过滤器的数据结构。 所以，请在你的模块的顶部插入如下语句：</p>
<pre><code>from django import template
register = template.Library()
</code></pre></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/06/09/no-module-named-xxx/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="You Wangqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/lufei.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Youmai の Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/06/09/no-module-named-xxx/" itemprop="url">no module named xxx</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-06-09T09:17:52+08:00">
                2015-06-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index">
                    <span itemprop="name">python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>python的常见错误，意思非常明确，这个模块找不到了。导致的原因也很确定：</p>
<ol>
<li>确实没有安装这个模块</li>
<li>路径不对</li>
</ol>
<p>第一个把模块安装上就完事了，第二个往往是导致这个错误最常见的原因。</p>
<p>如果你能确定你已经安装了这个模块，那肯定是import的路径有问题。import导入时，搜索的路径是有顺序的，查看当前python导入模块的搜索路径，可以在交互命令行中执行下面的命令：</p>
<pre><code>In [1]: import sys

In [2]: sys.path
Out[2]:
[&apos;&apos;,
 &apos;/System/Library/Frameworks/Python.framework/Versions/2.7/bin&apos;,
 &apos;/Library/Frameworks/Python.framework/Versions/2.7/lib/python27.zip&apos;,
 &apos;/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7&apos;,
 &apos;/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-darwin&apos;,
 &apos;/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-mac&apos;,
 &apos;/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-mac/lib-scriptpackages&apos;,
 &apos;/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-tk&apos;,
 &apos;/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-old&apos;,
 &apos;/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-dynload&apos;,
 &apos;/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages&apos;,
 &apos;/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/PIL&apos;,
 &apos;/Library/Python/2.7/site-packages&apos;,
 &apos;/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/IPython/extensions&apos;,
 &apos;/Users/youwangqiu/.ipython&apos;]
</code></pre><p>可以看到，我使用的python是现在当前路径(<code>&#39; &#39;</code>)下搜索，然后去系统的各个路径下搜索。而这个机制将<strong>导致一个很大的问题</strong>。</p>
<p>##不要乱给你的<code>.py</code>文件命名<br>你写了一个比较大的应用，多个<code>.py</code>文件，相互之间有<code>import</code>。给这些.py文件取名是件麻烦事，一般都是根据文件的功能来取名的嘛。所以你就将一个进行http请求的文件命名成了<code>requests.py</code>（同时，你的应用需要系统的<code>requests</code>模块）。调试整个应用的时候，你发现，这个<code>requests</code>模块怎么和教程上的不一样啊，怎么该有的函数都没有啊，要你有什么卵用！</p>
<p><code>requests</code>模块说：怪我喽…</p>
<p>大哥，你导入的不是系统的<code>requests</code>模块啊，你导入的是你的<code>requests.py</code>啊，当然什么都没有了。</p>
<p>这里虽然没有报<code>no module named</code>的错误，但是这个错误更难调试，和<code>no module named xxx</code>师出同源，如果你导入的requests模块下的一个函数或类的话，<code>no module named xxx</code>就出现了。</p>
<p>所以说给文件命名之前先考虑清楚，不要潇洒地随便写，不然你就是自己挖坑自己跳。</p>
<p>如果你发现自己确实犯了这个错误，并且改了文件名，请千万记住，还要<strong>把当前目录下相应的<code>.pyc</code>删除掉</strong>，不然还是没用，至于为什么，请自行参考任何一本python教程。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/06/05/django-高效更新数据库/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="You Wangqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/lufei.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Youmai の Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/06/05/django-高效更新数据库/" itemprop="url">Django-高效更新数据库</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-06-05T17:58:54+08:00">
                2015-06-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Django/" itemprop="url" rel="index">
                    <span itemprop="name">Django</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>模型的<code>save()</code>方法，这个方法会更新一行里的所有列。 而某些情况下，我们只需要更新行里的某几列。</p>
<p>例如说我们现在想要将<code>Apress Publisher</code>的名称由原来的<code>”Apress”</code>更改为<code>”Apress Publishing”</code>。若使用<code>save()</code>方法，如：</p>
<pre><code>&gt;&gt;&gt; p = Publisher.objects.get(name=&apos;Apress&apos;)
&gt;&gt;&gt; p.name = &apos;Apress Publishing&apos;
&gt;&gt;&gt; p.save()
</code></pre><p>这等同于如下SQL语句：</p>
<pre><code>SELECT id, name, address, city, state_province, country, website
FROM books_publisher
WHERE name = &apos;Apress&apos;;

UPDATE books_publisher SET
    name = &apos;Apress Publishing&apos;,
    address = &apos;2855 Telegraph Ave.&apos;,
    city = &apos;Berkeley&apos;,
    state_province = &apos;CA&apos;,
    country = &apos;U.S.A.&apos;,
    website = &apos;http://www.apress.com&apos;
WHERE id = 52;
（注意在这里我们假设Apress的ID为52）
</code></pre><p>在这个例子里我们可以看到<strong>Django的save()方法更新了不仅仅是name列的值，还有更新了所有的列</strong>。 若name以外的列有可能会被其他的进程所改动的情况下，只更改name列显然是更加明智的。 更改某一指定的列，我们可以调用结果集（QuerySet）对象的update()方法： 示例如下：</p>
<pre><code>&gt;&gt;&gt; Publisher.objects.filter(id=52).update(name=&apos;Apress Publishing&apos;)
</code></pre><p>与之等同的SQL语句变得更高效，并且不会引起竞态条件。</p>
<pre><code>UPDATE books_publisher
SET name = &apos;Apress Publishing&apos;
WHERE id = 52;
</code></pre><p><code>update()</code>方法对于任何结果集（<code>QuerySet</code>）均有效，这意味着你可以同时更新多条记录。 以下示例演示如何将所有<code>Publisher</code>的<code>country</code>字段值由<code>’U.S.A’</code>更改为<code>’USA’</code>：</p>
<pre><code>&gt;&gt;&gt; Publisher.objects.all().update(country=&apos;USA&apos;)
2
</code></pre><p>update()方法会返回一个整型数值，表示受影响的记录条数。 在上面的例子中，这个值是2。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/06/05/丢失私有密钥时连接到虚拟机-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="You Wangqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/lufei.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Youmai の Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/06/05/丢失私有密钥时连接到虚拟机-2/" itemprop="url">丢失私有密钥时连接到虚拟机(2)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-06-05T13:34:45+08:00">
                2015-06-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/openstack/" itemprop="url" rel="index">
                    <span itemprop="name">openstack</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>原理和<a href="http://michaelyou.github.io/2015/06/02/%E4%B8%A2%E5%A4%B1%E7%A7%81%E6%9C%89%E5%AF%86%E9%92%A5%E6%97%B6%E8%BF%9E%E6%8E%A5%E5%88%B0%E8%99%9A%E6%8B%9F%E6%9C%BA/" target="_blank" rel="external">丢失私有密钥时连接到虚拟机(1)</a>是一样的，从镜像创建的虚拟机我们也可以将其挂载到别的机器上，只是需要的命令不同。</p>
<p>##具体步骤</p>
<ul>
<li>关闭你的虚拟机</li>
<li>找到你的虚拟机的<code>id</code>，类似<code>282d0355-a4db-4467-a70b-4783ac2c7ed6</code>这样一串数字</li>
<li>找到你的虚拟机的宿主机，登录到宿主机上</li>
<li><p>进入到存放虚拟机文件的目录</p>
<pre><code>cd /var/lib/nova/instances/{id}
</code></pre><p>这里的<code>id</code>就是你上面虚拟机的<code>id</code><br>这个目录下的内容是这样的</p>
<pre><code>.
├── console.log
├── disk
├── disk.info
├── libvirt.xml
</code></pre><p>这里的disk文件就是我们要操作的对象</p>
</li>
<li><p>在当前目录下创建sysroot目录</p>
<pre><code>mkdir sysroot
</code></pre></li>
<li><p>挂载disk文件到本机</p>
<pre><code>guestmount -a disk --rw -m /dev/sda1  sysroot
</code></pre><p><strong>Note</strong>：如果你是ubuntu的系统，guestmount会报错如下：</p>
<pre><code>libguestfs: error: /usr/bin/supermin-helper exited with error status 1.
To see full error messages you may need to enable debugging.
See http://libguestfs.org/guestfs-faq.1.html#debugging-libguestfs
</code></pre><p>这个时候你可以执行：</p>
<pre><code>update-guestfs-appliance
</code></pre></li>
<li><p>进入sysroot并把它当作当前进程的根文件系统</p>
<pre><code>cd sysroot; chroot .
</code></pre></li>
<li><p>现在就可以修改虚拟机的文件啦！        </p>
</li>
<li><p>修改完成后，exit退出chroot的环境</p>
<pre><code>exit
cd ..  #回到上一级目录
umount sysroot
</code></pre></li>
<li><p>启动虚拟机即可</p>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/22/">22</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/img/lufei.jpeg"
               alt="You Wangqiu" />
          <p class="site-author-name" itemprop="name">You Wangqiu</p>
           
              <p class="site-description motion-element" itemprop="description">世之奇伟、瑰怪，非常之观，常在于险远，而人之所罕至焉，故非有志者不能至也</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">211</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">25</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">31</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/michaelyou" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                    
                      GitHub
                    
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.zhihu.com/people/zhi-yu-65-2" target="_blank" title="知乎">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                    
                      知乎
                    
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">You Wangqiu</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  

  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  






  





  

  

  

  

  

  

</body>
</html>
