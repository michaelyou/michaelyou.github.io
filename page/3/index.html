<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/img/lufei.ico?v=5.1.2" />






<meta name="description" content="世之奇伟、瑰怪，非常之观，常在于险远，而人之所罕至焉，故非有志者不能至也">
<meta property="og:type" content="website">
<meta property="og:title" content="Youmai の Blog">
<meta property="og:url" content="http://yoursite.com/page/3/index.html">
<meta property="og:site_name" content="Youmai の Blog">
<meta property="og:description" content="世之奇伟、瑰怪，非常之观，常在于险远，而人之所罕至焉，故非有志者不能至也">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Youmai の Blog">
<meta name="twitter:description" content="世之奇伟、瑰怪，非常之观，常在于险远，而人之所罕至焉，故非有志者不能至也">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"right","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/3/"/>





  <title>Youmai の Blog</title>
  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-63551049-1', 'auto');
  ga('send', 'pageview');
</script>





</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-right 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Youmai の Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/07/19/python排序函数/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="You Wangqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/lufei.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Youmai の Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/07/19/python排序函数/" itemprop="url">python排序函数</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-07-19T21:38:15+08:00">
                2015-07-19
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index">
                    <span itemprop="name">python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>##sort和sorted<br>相比于<code>sort</code>，<code>sorted()</code>的使用更为广泛</p>
<pre><code>sorted(iterable, cmp, key, reverse)
s.sort(cmp, key, reverse)
</code></pre><p><code>sorted</code>可以作用域任意迭代对象，而<code>sort()</code>一般作用于列表。</p>
<p><code>reverse = True</code>表示按照逆序排序</p>
<p>##sorted</p>
<p><code>sorted</code>排序的关键是传入<code>key</code>：</p>
<pre><code>In [35]: students = [(&apos;john&apos;, &apos;A&apos;, 15), (&apos;jane&apos;, &apos;B&apos;, 12), (&apos;dave&apos;, &apos;B&apos;, 10), (&apos;michael&apos;, &apos;A&apos;, 13), (&apos;mike&apos;, &apos;B&apos;, 12), (&apos;jessey&apos;, &apos;C&apos;, 15)]

In [36]: students = sorted(students, key=lambda result: result[2], reverse=True)
</code></pre><p>结果：</p>
<pre><code>In [37]: students
Out[37]:
[(&apos;john&apos;, &apos;A&apos;, 15),
 (&apos;jessey&apos;, &apos;C&apos;, 15),
 (&apos;michael&apos;, &apos;A&apos;, 13),
 (&apos;jane&apos;, &apos;B&apos;, 12),
 (&apos;mike&apos;, &apos;B&apos;, 12),
 (&apos;dave&apos;, &apos;B&apos;, 10)]
</code></pre><p>如果我们对排序有更高的要求，比如在本例中，在按年龄排序之后，我们还希望对年龄相同的同学按照等级进行排序。我们可以这样写<code>key</code></p>
<pre><code>In [38]: students = sorted(students, key=lambda result: (result[2], result[1]), reverse=True)

In [39]: students
Out[39]:
[(&apos;jessey&apos;, &apos;C&apos;, 15),
 (&apos;john&apos;, &apos;A&apos;, 15),
 (&apos;michael&apos;, &apos;A&apos;, 13),
 (&apos;jane&apos;, &apos;B&apos;, 12),
 (&apos;mike&apos;, &apos;B&apos;, 12),
 (&apos;dave&apos;, &apos;B&apos;, 10)]
</code></pre><p><a href="http://stackoverflow.com/questions/4233476/sort-a-list-by-multiple-attributes" target="_blank" rel="external">stackoverflow: Sort a list by multiple attributes?</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/06/30/HTML5与CSS3基础教程/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="You Wangqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/lufei.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Youmai の Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/06/30/HTML5与CSS3基础教程/" itemprop="url">《HTML5与CSS3基础教程》</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-06-30T14:21:36+08:00">
                2015-06-30
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/web/" itemprop="url" rel="index">
                    <span itemprop="name">web</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>##HTML</p>
<ol>
<li>html文件的文件名全部使用小写字母，用短横线分割单词</li>
<li>a = anchor(锚)</li>
<li>每个浏览器都有一个内置的CSS文件，它决定了每个HTML元素的默认样式。你自己创建的CSS可以覆盖这些样式。</li>
<li>small元素表示的含义是法律声明等条文细则</li>
<li>header用于创建页眉，通常情况下，页眉包括网站标志，主导航和其他全站链接，甚至搜索框。只在必要时使用header。大多数情况下，如果h1~h6能满足要求，就没有必要用header将其包起来。</li>
<li>main是HTML5新添加的元素，包围着代表页面主题的内容，在一个页面里仅使用一次</li>
<li>article是HTML5新增元素。内容可以包含任意数量的元素。元素类型包括段落，列表，音频，视频，图像，图形等</li>
<li>aside是HTML5的新增元素。用于页面的附注栏。内容可以包含任意数量的元素。元素类型包括段落，列表，音频，视频，图，图形等。</li>
<li>HTML5中引入了大量新的标签，很多就是为了取代div。在HTML5中，div并没有消失，只是使用它的场合变少了。P55</li>
<li>cite元素用于标识对艺术作品，电影，图书等内容的引用</li>
<li>strong标记重要文本，em标记想要强调的文本</li>
<li>blockquote用于标记引述的文本 P70</li>
<li>abbr元素标记缩写词并解释其含义</li>
<li>dfn标记要定义的术语</li>
<li>sub创建下标，sup创建上标</li>
<li>del标记已删除内容(在内容上划线)</li>
<li>mark标记是荧光笔效果，用于突出显示文本</li>
<li>span –P88</li>
</ol>
<p>##表单</p>
<ol>
<li>表单中的每个控件都有一个name属性，用于提交表单时对数据进行识别</li>
<li>有的表单元素有内置的验证功能，有的网站使用javascript进行验证，这些都不能完全代替服务器端的验证，因为旧的浏览器或完全禁用javascript的浏览器不会执行客户端验证。</li>
<li>分隔表单元素可以使用p和div</li>
<li>为表单添加标签。label元素有一个特殊的属性：for。如果for的值域一个表单字段的id值相同，该label就与该字段显式地关联起来了。这对提升表单的可用性和可访问性都有帮助。–P330</li>
<li>单选按钮中的value属性的值，在该按钮被选中提交后，将会提交给服务器。</li>
<li>访问者输入的信息不发送到服务器就没什么用。应该总是为表单创建提交按钮，让访问者将信息交给你。submit–P343</li>
<li></li>
</ol>
<p>##CSS</p>
<ol>
<li>注释写在<code>/*  */</code>中</li>
<li>当你为某个元素应用CSS属性时，这些属性不仅会影响该元素，还会影响其下的分支元素。也就是说，这些下层的元素继承了其祖先元素的属性</li>
<li>哪些属性会被继承–P128</li>
<li>按类或ID选择元素， 类用<code>.</code>(点号)，ID用<code>#</code>(井号)</li>
<li>创建斜体：<code>font-style:italic</code>  –P176</li>
<li>应用粗体：<code>font-weight:bold</code> –P177</li>
<li>设置行高：<code>line-height:xxx</code></li>
</ol>
<p>##用CSS进行布局</p>
<ol>
<li>CSS让页面富有活力，但是首先我们应该知道，高校网页的核心是结构良好，语义化的HTML</li>
<li>盒模型–P211，209<ul>
<li>内容区域</li>
<li>内容区域周围的空间（内边距–padding）</li>
<li>内边距的外边缘（边框–border）</li>
<li>边框外面将元素与相邻元素隔开的不可见区域（外边距–margin）</li>
</ul>
</li>
<li>设置边框–P219</li>
<li>让文本环绕元素–设置浮动。分栏就是这么设计的</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/06/30/JavaScript-DOM编程艺术/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="You Wangqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/lufei.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Youmai の Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/06/30/JavaScript-DOM编程艺术/" itemprop="url">《JavaScript DOM编程艺术》</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-06-30T14:19:00+08:00">
                2015-06-30
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/JavaScript/" itemprop="url" rel="index">
                    <span itemprop="name">JavaScript</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ol>
<li>javascript语言的另两个名字是ECMAScript和JScript，它们都是同一种语言，随便你怎么称呼它。</li>
</ol>
<ul>
<li>DOM = Document Object Model = 文档对象模型</li>
<li>在js中，在每条语句的后面加上一个<code>;</code>，是一种良好的编程习惯。</li>
<li>js允许程序员直接对变量赋值而无需事先声明，但是提前声明是一种良好的编程习惯</li>
<li>Javascript 的数组<code>Array</code>,既是一个<strong>数组</strong>，也是一个<strong>字典</strong><code>(Dictionary)</code></li>
<li>js支持<code>++</code>和<code>+=</code>操作符，python不支持<code>++</code></li>
<li>js支持三元操作符<code>a?b:c</code>, python不支持</li>
<li>在几乎所有浏览器里，用<code>Tab</code>键移动到某个链接然后按下回车键的动作也会触发<code>onclick</code>事件</li>
<li>HTML DOM提供了很多属性，可以让我们更方便地处理网页(P93).</li>
<li>把新创建的节点插入某个文档的节点树的最简单的方法是，让他成为这个文档某个现有节点的一个子节点</li>
<li>DOM提供了insertBefore方法，但是没有提供insertAfter方法。但我们可以自己编写insertAfter方法(P110).</li>
<li>到目前为止，各大搜索引擎网站的搜索机器人还几乎不支持javascript</li>
</ul>
<p>##变量作用域<br>如果在某个函数中使用了var，那个变量就会被视为一个全局变量，它只存在于这个函数的上下文中；反之，如果没有使用var，那个变量就会被视为一个全局变量，如果脚本里已经存在一个与之同名的全局变量，这个函数就会改变那个全局变量的值。</p>
<p>##js文档放在哪里最好<br>最好的做法是把<code>&lt;script&gt;</code>标签放在<code>HTML</code>文档的最后，<code>&lt;/body&gt;</code>标签之前，这样能使浏览器更快地加载页面。</p>
<p>##在页面加载完毕后执行函数<br>最佳的解决方法是编写<code>addLoadEvent</code>方法(P83)，这个函数将会把那些在页面加载完毕时执行的函数创建为一个队列。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/06/30/jQuery选择器中的空格/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="You Wangqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/lufei.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Youmai の Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/06/30/jQuery选择器中的空格/" itemprop="url">jQuery选择器中的空格</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-06-30T11:23:25+08:00">
                2015-06-30
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/jQuery/" itemprop="url" rel="index">
                    <span itemprop="name">jQuery</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#jQuery选择器中的空格<br>来自–《锋利的jQuery》</p>
<p>选择器中的空格是不容忽视的，多一个空格或少一个空格也许得到的结果会截然不同的。下面来看一个例子。</p>
<p>HTML代码如下：</p>
<pre><code>&lt;div class=&quot;test&quot;&gt;
&lt;div style=&quot;display:none;&quot;&gt;Jquery教程&lt;/div&gt;
&lt;div style=&quot;display:none;&quot;&gt;Jquery学习&lt;/div&gt;
&lt;div style=&quot;display:none;&quot;&gt;Jquery插件&lt;/div&gt;
&lt;div class=&quot;test&quot; style=&quot;display:none;&quot;&gt;PHP学习&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;test&quot; style=&quot;display:none;&quot;&gt;Jquery插件教程&lt;/div&gt;
&lt;div class=&quot;test&quot; style=&quot;display:none;&quot;&gt;Jquery插件学习&lt;/div&gt;
</code></pre><p>使用如下jQuery代码获取它们：</p>
<pre><code>var $test_a = $(&quot;.test :hidden&quot;);//带空格的jQuery选择器
var $test_b = $(&quot;.test:hidden&quot;);//不带空格的jQuery选择器
var len_a = $test_a.length;
var len_b = $test_b.length;
alert(&quot;带空格的jQuery选择器选出的jQuery元素是：&quot;+len_a+&quot;个&quot;);//输出为4个
alert(&quot;不带空格的jQuery选择器选出的jQuery元素是：&quot;+len_b+&quot;个&quot;);//输出为3个
</code></pre><p>之所以会出现不同的结果，这就是后代选择器和过滤选择器的不同了</p>
<pre><code>var $test_a = $(&quot;.test :hidden&quot;);//带空格的jQuery选择器
</code></pre><p>上面这段代码是选取class为“test”的元素里面的隐藏元素。（后代选择器）</p>
<pre><code>var $test_b = $(&quot;.test:hidden&quot;);//不带空格的jQuery选择器
</code></pre><p>这上面的代码则是选取隐藏的class为“test”的元素</p>
<p>###<strong>注意</strong>:<br>有的选择器的用法，必须是空格，如果不带空格的话，那就取不到元素，比如：</p>
<pre><code>$(&quot;select:selected&quot;).length;//不管任何时候，这个选择器都取不到元素，这个length必然是0
$(&quot;select :selected&quot;);//这样才是正确的
</code></pre><p>有的选择器的用法，必须不带空格，如果带空格的话，那就取不到元素，比如：</p>
<pre><code>$(&quot;input :checked&quot;).length;//不管任何时候，这个选择器都取不到元素，这个length必然是0
$(&quot;input:checked&quot;);//这样才是正确的
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/06/13/python中定义常量/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="You Wangqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/lufei.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Youmai の Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/06/13/python中定义常量/" itemprop="url">python中定义常量</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-06-13T14:25:03+08:00">
                2015-06-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index">
                    <span itemprop="name">python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>实际开发中我们经常会碰到需要定义常量的情形，c语言提供了const关键字来实现，但是python本身却没有提供const，要想在python代码中定义常量，需要我们自己来实现。</p>
<p>下面定义一个const类。要求符合<strong>“命名全部为大写”</strong>和<strong>“值一旦绑定便不可再修改”</strong>这两个条件。<a href="https://github.com/michaelyou/useful-python-code/tree/master/const" target="_blank" rel="external">代码</a></p>
<pre><code>class const(object):
    class ConstError(TypeError): 
        pass
    class ConstCaseError(ConstError):
        pass

    def __setattr__(self, name, value):
        if self.__dict__.has_key(name):
            raise self.ConstError, &quot;can&apos;t change const.%s&quot; % name
        if not name.isupper():
            raise self.ConstCaseError, &quot;const name &apos;%s&apos; is not all uppercase&quot; % name

        self.__dict__[name] = value

import sys
sys.modules[__name__] = const()
</code></pre><p>这里通过对常量对应的值进行修改时或者命名不符合规范时抛出异常来满足以上常量的两个条件。</p>
<p>###NOTE</p>
<p>使用sys.modules[name]可以获取一个模块对象，并可以通过该对象获取模块的属性，这儿使用了sys.modules向系统字典注入了一个const对象从而实现了在执行import const时实际获取了一个const实例的功能，sys.module在文档中的描述如下：</p>
<blockquote>
<p>sys.modules</p>
<p>This is a dictionary that maps module names to modules which have already been loaded. This can be manipulated to force reloading of modules and other tricks. Note that removing a module from this dictionary is not the same as calling reload() on the corresponding module object.</p>
</blockquote>
<p>sys.modules[name] = const()这行代码将系统已经加载的模块列表中的const替换为了const()，即一个const实例</p>
<p>##使用<br>整个工程需要使用的常量都应该定义在一个文件中。例如你将const.py放在了project.utils目录下，常量被定义在project.apps目录下的project_consts.py文件中，那么应该这么写：</p>
<pre><code>#project_consts.py
from project.utils import const

const.NAME = &apos;IBM&apos;
const.EMAIL = &apos;ibm.com&apos;
</code></pre><p>在其他文件中需要使用这些常量时，用如下方式调用：</p>
<pre><code>from project.apps.project_consts import const

print const.NAME
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/06/12/再读the-django-book-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="You Wangqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/lufei.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Youmai の Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/06/12/再读the-django-book-1/" itemprop="url">再读《the Django book》</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-06-12T00:06:56+08:00">
                2015-06-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Django/" itemprop="url" rel="index">
                    <span itemprop="name">Django</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li><p>登录进数据库服务器看Django创建的数据表，除了手动启动命令行客户端，还可以执行</p>
<pre><code>python manage.py dbshell
</code></pre><p>这个命令将依据<code>DATABASE_SERVER</code> 的里设置自动检测使用哪种命令行客户端</p>
</li>
<li><p><strong><code>添加模块的字符串表现</code></strong>，这个讲的就是给模型添加<code>__unicode__()</code>方法，<code>__unicode__()</code>方法告诉python如何将对象以unicode的方式显示出来。</p>
</li>
</ul>
<ul>
<li><p>使用<code>Publisher.objects,all()</code>来选择所有数据时，SQL语句执行的是：</p>
<pre><code>SELECT id, name, address, city, state_province, country, website 
FROM books_publisher;
</code></pre><p>并没有使用 <code>SELECT *</code>，而是<strong>显式列出了所有字段</strong>。 设计的时候就是这样： <code>SELECT *</code> 会更慢，而且最重要的是列出所有字段遵循了Python 界的一个信条： <strong>明言胜于暗示</strong>。</p>
</li>
<li><p>你可以在任意一个模型类中使用 <code>Meta</code> 类，来设置一些与特定模型相关的选项。例如设置<code>ordering</code>这个选项。如果你设置了这个选项，那么除非你检索时特意额外地使用了 <code>order_by()</code>，否则，当你使用 Django 的数据库 API 去检索时，这个模型的对象的相关返回值默认地都会按<code>ordering</code>设置的字段排序。</p>
</li>
<li><p>你需要一段<code>context</code>来解析模板。 一般情况下，这是一个 <code>django.template.Context</code> 的实例，不过在Django中还可以用一个特殊的子类， <code>django.template.RequestContext</code>，这个用起来稍微有些不同。 <code>RequestContext</code> 默认地在模板<code>context</code>中加入了一些变量，如 <code>HttpRequest</code> 对象或当前登录用户的相关信息。</p>
</li>
<li><p>在模板中判断当前是否处在debug模式下，可以启动<code>django.core.context_processors.debug</code>，它返回值中的<code>debug</code>字段就是<code>setting</code>中的<code>debug</code></p>
</li>
<li><p>作为合法的标签库，模块需要包含一个名为<code>register</code>的模块级变量。这个变量是<code>template.Library</code>的实例，是所有注册标签和过滤器的数据结构。 所以，请在你的模块的顶部插入如下语句：</p>
<pre><code>from django import template
register = template.Library()
</code></pre></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/06/09/no-module-named-xxx/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="You Wangqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/lufei.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Youmai の Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/06/09/no-module-named-xxx/" itemprop="url">no module named xxx</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-06-09T09:17:52+08:00">
                2015-06-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python/" itemprop="url" rel="index">
                    <span itemprop="name">python</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>python的常见错误，意思非常明确，这个模块找不到了。导致的原因也很确定：</p>
<ol>
<li>确实没有安装这个模块</li>
<li>路径不对</li>
</ol>
<p>第一个把模块安装上就完事了，第二个往往是导致这个错误最常见的原因。</p>
<p>如果你能确定你已经安装了这个模块，那肯定是import的路径有问题。import导入时，搜索的路径是有顺序的，查看当前python导入模块的搜索路径，可以在交互命令行中执行下面的命令：</p>
<pre><code>In [1]: import sys

In [2]: sys.path
Out[2]:
[&apos;&apos;,
 &apos;/System/Library/Frameworks/Python.framework/Versions/2.7/bin&apos;,
 &apos;/Library/Frameworks/Python.framework/Versions/2.7/lib/python27.zip&apos;,
 &apos;/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7&apos;,
 &apos;/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-darwin&apos;,
 &apos;/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-mac&apos;,
 &apos;/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/plat-mac/lib-scriptpackages&apos;,
 &apos;/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-tk&apos;,
 &apos;/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-old&apos;,
 &apos;/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/lib-dynload&apos;,
 &apos;/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages&apos;,
 &apos;/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/PIL&apos;,
 &apos;/Library/Python/2.7/site-packages&apos;,
 &apos;/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/IPython/extensions&apos;,
 &apos;/Users/youwangqiu/.ipython&apos;]
</code></pre><p>可以看到，我使用的python是现在当前路径(<code>&#39; &#39;</code>)下搜索，然后去系统的各个路径下搜索。而这个机制将<strong>导致一个很大的问题</strong>。</p>
<p>##不要乱给你的<code>.py</code>文件命名<br>你写了一个比较大的应用，多个<code>.py</code>文件，相互之间有<code>import</code>。给这些.py文件取名是件麻烦事，一般都是根据文件的功能来取名的嘛。所以你就将一个进行http请求的文件命名成了<code>requests.py</code>（同时，你的应用需要系统的<code>requests</code>模块）。调试整个应用的时候，你发现，这个<code>requests</code>模块怎么和教程上的不一样啊，怎么该有的函数都没有啊，要你有什么卵用！</p>
<p><code>requests</code>模块说：怪我喽…</p>
<p>大哥，你导入的不是系统的<code>requests</code>模块啊，你导入的是你的<code>requests.py</code>啊，当然什么都没有了。</p>
<p>这里虽然没有报<code>no module named</code>的错误，但是这个错误更难调试，和<code>no module named xxx</code>师出同源，如果你导入的requests模块下的一个函数或类的话，<code>no module named xxx</code>就出现了。</p>
<p>所以说给文件命名之前先考虑清楚，不要潇洒地随便写，不然你就是自己挖坑自己跳。</p>
<p>如果你发现自己确实犯了这个错误，并且改了文件名，请千万记住，还要<strong>把当前目录下相应的<code>.pyc</code>删除掉</strong>，不然还是没用，至于为什么，请自行参考任何一本python教程。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/06/05/django-高效更新数据库/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="You Wangqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/lufei.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Youmai の Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/06/05/django-高效更新数据库/" itemprop="url">Django-高效更新数据库</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-06-05T17:58:54+08:00">
                2015-06-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Django/" itemprop="url" rel="index">
                    <span itemprop="name">Django</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>模型的<code>save()</code>方法，这个方法会更新一行里的所有列。 而某些情况下，我们只需要更新行里的某几列。</p>
<p>例如说我们现在想要将<code>Apress Publisher</code>的名称由原来的<code>”Apress”</code>更改为<code>”Apress Publishing”</code>。若使用<code>save()</code>方法，如：</p>
<pre><code>&gt;&gt;&gt; p = Publisher.objects.get(name=&apos;Apress&apos;)
&gt;&gt;&gt; p.name = &apos;Apress Publishing&apos;
&gt;&gt;&gt; p.save()
</code></pre><p>这等同于如下SQL语句：</p>
<pre><code>SELECT id, name, address, city, state_province, country, website
FROM books_publisher
WHERE name = &apos;Apress&apos;;

UPDATE books_publisher SET
    name = &apos;Apress Publishing&apos;,
    address = &apos;2855 Telegraph Ave.&apos;,
    city = &apos;Berkeley&apos;,
    state_province = &apos;CA&apos;,
    country = &apos;U.S.A.&apos;,
    website = &apos;http://www.apress.com&apos;
WHERE id = 52;
（注意在这里我们假设Apress的ID为52）
</code></pre><p>在这个例子里我们可以看到<strong>Django的save()方法更新了不仅仅是name列的值，还有更新了所有的列</strong>。 若name以外的列有可能会被其他的进程所改动的情况下，只更改name列显然是更加明智的。 更改某一指定的列，我们可以调用结果集（QuerySet）对象的update()方法： 示例如下：</p>
<pre><code>&gt;&gt;&gt; Publisher.objects.filter(id=52).update(name=&apos;Apress Publishing&apos;)
</code></pre><p>与之等同的SQL语句变得更高效，并且不会引起竞态条件。</p>
<pre><code>UPDATE books_publisher
SET name = &apos;Apress Publishing&apos;
WHERE id = 52;
</code></pre><p><code>update()</code>方法对于任何结果集（<code>QuerySet</code>）均有效，这意味着你可以同时更新多条记录。 以下示例演示如何将所有<code>Publisher</code>的<code>country</code>字段值由<code>’U.S.A’</code>更改为<code>’USA’</code>：</p>
<pre><code>&gt;&gt;&gt; Publisher.objects.all().update(country=&apos;USA&apos;)
2
</code></pre><p>update()方法会返回一个整型数值，表示受影响的记录条数。 在上面的例子中，这个值是2。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/06/05/丢失私有密钥时连接到虚拟机-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="You Wangqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/lufei.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Youmai の Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/06/05/丢失私有密钥时连接到虚拟机-2/" itemprop="url">丢失私有密钥时连接到虚拟机(2)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-06-05T13:34:45+08:00">
                2015-06-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/openstack/" itemprop="url" rel="index">
                    <span itemprop="name">openstack</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>原理和<a href="http://michaelyou.github.io/2015/06/02/%E4%B8%A2%E5%A4%B1%E7%A7%81%E6%9C%89%E5%AF%86%E9%92%A5%E6%97%B6%E8%BF%9E%E6%8E%A5%E5%88%B0%E8%99%9A%E6%8B%9F%E6%9C%BA/" target="_blank" rel="external">丢失私有密钥时连接到虚拟机(1)</a>是一样的，从镜像创建的虚拟机我们也可以将其挂载到别的机器上，只是需要的命令不同。</p>
<p>##具体步骤</p>
<ul>
<li>关闭你的虚拟机</li>
<li>找到你的虚拟机的<code>id</code>，类似<code>282d0355-a4db-4467-a70b-4783ac2c7ed6</code>这样一串数字</li>
<li>找到你的虚拟机的宿主机，登录到宿主机上</li>
<li><p>进入到存放虚拟机文件的目录</p>
<pre><code>cd /var/lib/nova/instances/{id}
</code></pre><p>这里的<code>id</code>就是你上面虚拟机的<code>id</code><br>这个目录下的内容是这样的</p>
<pre><code>.
├── console.log
├── disk
├── disk.info
├── libvirt.xml
</code></pre><p>这里的disk文件就是我们要操作的对象</p>
</li>
<li><p>在当前目录下创建sysroot目录</p>
<pre><code>mkdir sysroot
</code></pre></li>
<li><p>挂载disk文件到本机</p>
<pre><code>guestmount -a disk --rw -m /dev/sda1  sysroot
</code></pre><p><strong>Note</strong>：如果你是ubuntu的系统，guestmount会报错如下：</p>
<pre><code>libguestfs: error: /usr/bin/supermin-helper exited with error status 1.
To see full error messages you may need to enable debugging.
See http://libguestfs.org/guestfs-faq.1.html#debugging-libguestfs
</code></pre><p>这个时候你可以执行：</p>
<pre><code>update-guestfs-appliance
</code></pre></li>
<li><p>进入sysroot并把它当作当前进程的根文件系统</p>
<pre><code>cd sysroot; chroot .
</code></pre></li>
<li><p>现在就可以修改虚拟机的文件啦！        </p>
</li>
<li><p>修改完成后，exit退出chroot的环境</p>
<pre><code>exit
cd ..  #回到上一级目录
umount sysroot
</code></pre></li>
<li><p>启动虚拟机即可</p>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/06/02/丢失私有密钥时连接到虚拟机/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="You Wangqiu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/lufei.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Youmai の Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/06/02/丢失私有密钥时连接到虚拟机/" itemprop="url">丢失私有密钥时连接到虚拟机(1)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-06-02T15:01:22+08:00">
                2015-06-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/openstack/" itemprop="url" rel="index">
                    <span itemprop="name">openstack</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>有一些镜像制作的时候，只允许使用ssh登陆。所以一般创建虚拟机时，我们会将自己的公钥通过ec2的meta服务写入虚拟机，而后在本地通过和公钥一起生成的私钥登陆。</p>
<p>但是，既然是钥匙，就具备了<code>“丢“</code>的属性，如果我们丢失了本地的私钥，那不就不能登陆虚拟机了？其实倒也不至于不能登陆，只是费事一点罢了。</p>
<p>原理是这样:你需要将本虚拟机的云硬盘(volume)断开，将云硬盘作为数据卷挂载到另一台虚拟机上，然后修改 authorized_keys 文件，将云硬盘挂载回原虚拟机，重启虚拟机即可。</p>
<p><strong>Note</strong>：本教程适用的虚拟机必须是从云硬盘创建的，从<strong>镜像或者快照</strong>创建的请参考<a href="http://michaelyou.github.io/2015/06/05/%E4%B8%A2%E5%A4%B1%E7%A7%81%E6%9C%89%E5%AF%86%E9%92%A5%E6%97%B6%E8%BF%9E%E6%8E%A5%E5%88%B0%E8%99%9A%E6%8B%9F%E6%9C%BA-2/" target="_blank" rel="external">丢失私有密钥时连接到虚拟机(2)</a></p>
<p><img src="http://7xj6cl.com1.z0.glb.clouddn.com/launch.png" alt=""></p>
<p>###具体步骤</p>
<ul>
<li>暂停虚拟机，点击左侧导航栏的<strong>云硬盘</strong>，选择本机A的云硬盘，将其从本机断开</li>
<li>还是在<strong>云硬盘</strong>的目录，将此<strong>云硬盘</strong>挂载到另一台虚拟机B</li>
</ul>
<p><img src="http://7xj6cl.com1.z0.glb.clouddn.com/volume.png" alt=""></p>
<ul>
<li><p>登陆到虚拟机B，执行<code>lsblk</code>,命令确定volume是否已分区</p>
<pre><code>ubuntu@key-test1:~$ lsblk
NAME   MAJ:MIN RM SIZE RO TYPE MOUNTPOINT
vda    253:0    0  10G  0 disk 
└─vda1 253:1    0  10G  0 part /
vdb    253:16   0  10G  0 disk 
└─vdb1 253:17   0  10G  0 part
</code></pre><p>截图中已经说明，<code>在设备/dev/vdb上连接到key_test1</code>，所以最后一行的<code>vdb1</code>就是我们挂载过来的云硬盘。</p>
</li>
<li><p>创建临时目录以安装volume</p>
</li>
</ul>
<pre><code>ubuntu@key-test1:~$ sudo mkdir /mnt/tempvol
</code></pre><ul>
<li><p>使用之前确定的volume名称或设备名称在临时安装点安装volume（或分区）</p>
<pre><code>ubuntu@key-test1:~$ sudo mount /dev/vdb1 /mnt/tempvol
</code></pre></li>
<li><p>这样你进入<code>/mnt/tempvol</code>目录就是进入了挂载的云硬盘，修改<code>authorized_keys</code>文件，删除失效的<code>public_key</code>，添加新的<code>public_key</code></p>
<pre><code>ubuntu@key-test1:~$ vim /mnt/tempvol/home/ubuntu/.ssh/authorized_keys
</code></pre></li>
<li><p>修改完成后，卸载已连接的volume，以将其重新连接至原始实例</p>
<pre><code>ubuntu@key-test1:~$ sudo umount /mnt/tempvol
</code></pre></li>
</ul>
<p><strong>Note</strong>：卸载时可能会出现设备忙的告警，多试几次即可</p>
<p>回到<code>openstack</code>的控制面，将云硬盘重新挂载到机器A，启动机器A即可从拥有私钥的那台机器上登陆</p>
<p>##参考<br><a href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-key-pairs.html" target="_blank" rel="external">Amazon EC2 Key Pairs</a></p>
<p><a href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html" target="_blank" rel="external">Instance Metadata and User Data</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/21/">21</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/img/lufei.jpeg"
               alt="You Wangqiu" />
          <p class="site-author-name" itemprop="name">You Wangqiu</p>
           
              <p class="site-description motion-element" itemprop="description">世之奇伟、瑰怪，非常之观，常在于险远，而人之所罕至焉，故非有志者不能至也</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">210</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">24</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">31</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/michaelyou" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                    
                      GitHub
                    
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.zhihu.com/people/zhi-yu-65-2" target="_blank" title="知乎">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                    
                      知乎
                    
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">You Wangqiu</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  

  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  






  





  

  

  

  

  

  

</body>
</html>
